[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (20.77 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.84 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.52 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.75 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/refresh from unknown -> 200 (2.77 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/logout from unknown -> 204 (0.65 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/refresh from unknown -> 401 (1.05 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.35 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.48 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (3.73 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /api/campaigns from unknown -> 200 (1.71 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.48 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.50 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.04 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (2.59 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/applications from unknown -> 201 (3.32 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/payments from unknown -> 201 (3.34 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (29.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/notifications/mark-read from unknown -> 200 (2.24 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.23 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (1.78 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.35 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (3.69 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] PATCH /api/orders/745d1257-ad4e-4a42-be57-3150c04a8dfc from unknown -> 200 (2.05 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /api/notifications from unknown -> 200 (1.75 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.21 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (1.69 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/payments from unknown -> 201 (1.77 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] POST /api/webhooks/payment from unknown -> 200 (2.61 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /api/notifications from unknown -> 200 (1.45 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.69 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.74 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.60 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.60 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.55 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.50 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.50 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.49 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.53 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.58 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.50 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.60 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.64 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.59 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.48 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.81 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.58 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.50 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.50 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.49 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.59 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.67 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.84 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.56 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.53 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.58 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.50 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.49 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (4.34 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.58 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.90 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.59 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.55 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (1.06 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.64 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.63 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-16 18:18:47] WARNING — Rate limit exceeded for %s
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 429 (1.37 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.67 ms)
[2025-10-16 18:18:47] INFO — [REQUEST] GET /health from unknown -> 200 (0.77 ms)
[2025-10-16 18:39:19] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (23.57 ms)
[2025-10-16 18:39:19] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.77 ms)
[2025-10-17 01:25:22] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (20.47 ms)
[2025-10-17 01:25:22] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.97 ms)
[2025-10-17 01:25:22] INFO — [REQUEST] GET /api/admin/users from unknown -> 403 (1.85 ms)
[2025-10-17 01:25:22] INFO — admin_action method=GET path=/api/admin/users status=403 admin_id=509e6536-3838-48c4-8738-65189422f28b
[2025-10-17 01:25:22] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.57 ms)
[2025-10-17 01:25:22] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.65 ms)
[2025-10-17 01:25:22] INFO — [REQUEST] GET /api/admin/users from unknown -> 200 (2.24 ms)
[2025-10-17 01:25:22] INFO — admin_action method=GET path=/api/admin/users status=200 admin_id=e4ffe7b1-f4ff-42f2-8856-a42743d6427b
[2025-10-17 01:25:22] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.25 ms)
[2025-10-17 01:25:22] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.61 ms)
[2025-10-17 01:25:22] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.14 ms)
[2025-10-17 01:25:22] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (2.18 ms)
[2025-10-17 01:25:22] ERROR — Unhandled exception at %s
  + Exception Group Traceback (most recent call last):
  |
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                │     │                      └ <anyio._backends._asyncio.TaskGroup object at 0x1064ab9d0>
  |                │     └ <function create_task_group at 0x102224d60>
  |                └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x106264fe0>
    |           │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1021131a0>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
    |           │    └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1061c1a10>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x1033fede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x100e95840>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x1064efae0>
    |     └ <contextlib._GeneratorContextManager object at 0x1064a8150>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x106264c20>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x1064a9a90>
    |                      │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>>
    |                      └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x1064a9a90>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x106264c20>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type AdminLevel is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x106265d00>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062649a0>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
    |           │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>
    |           └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x1033fede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x1062cb640>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x1064ee7a0>
    |     └ <contextlib._GeneratorContextManager object at 0x1064a86d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1062658a0>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x1064ab0d0>
    |                      │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>>
    |                      └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x1064ab0d0>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1062658a0>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type AdminLevel is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x106265080>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x106265760>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
    |           │    └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>
    |           └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x1033fede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x1062c8240>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x1064ecac0>
    |     └ <contextlib._GeneratorContextManager object at 0x1062e7490>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1062d1940>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x1062e5590>
    |                      │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>>
    |                      └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    |     return await call_next(request)
    |                  │         └ <starlette.middleware.base._CachedRequest object at 0x1062e5590>
    |                  └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1062d1940>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type AdminLevel is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1062d27a0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1061c1ad0>
    |           └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1062d27a0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1061c1110>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x1061c1ad0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1062d27a0>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
    |           │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
    |           │                            │    │    └ <starlette.requests.Request object at 0x1062cc0d0>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1061c1110>
    |           └ <function wrap_app_handling_exceptions at 0x10486aca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1062d2160>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
    |           │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
    |           └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1062d2160>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
    |           │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1060ec4d0>>
    |           └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1062d2160>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
    |           │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
    |           │     └ <function Route.handle at 0x10489c4a0>
    |           └ APIRoute(path='/api/admin/users/{user_id}/role', name='update_user_role', methods=['PATCH'])
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1062d2160>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
    |           │    └ <function request_response.<locals>.app at 0x106132340>
    |           └ APIRoute(path='/api/admin/users/{user_id}/role', name='update_user_role', methods=['PATCH'])
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1062d2160>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
    |           │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
    |           │                            │    └ <starlette.requests.Request object at 0x1062cf6d0>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x1062d0f40>
    |           └ <function wrap_app_handling_exceptions at 0x10486aca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1062d1260>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
    |           │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x1062d0f40>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    |     response = await func(request)
    |                      │    └ <starlette.requests.Request object at 0x1062cf6d0>
    |                      └ <function get_request_handler.<locals>.app at 0x106132200>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |                          └ <function run_endpoint_function at 0x100a9f740>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |                  │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x106328f90>, 'admin_user': <app.models.user.User object at 0x1033bce90>, 'u...
    |                  │                 │         └ <function update_user_role at 0x105fdaca0>
    |                  │                 └ <fastapi.dependencies.models.Dependant object at 0x10614fd50>
    |                  └ <function run_in_threadpool at 0x10316f2e0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |                  │     │         │        │      └ ()
    |                  │     │         │        └ functools.partial(<function update_user_role at 0x105fdaca0>, db=<sqlalchemy.orm.session.Session object at 0x106328f90>, admi...
    |                  │     │         └ <function run_sync at 0x102146a20>
    |                  │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
    |                  └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |                  └ <function get_async_backend at 0x102145d00>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    |     return await future
    |                  └ <Future finished exception=TypeError('Object of type AdminLevel is not JSON serializable')>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    |     result = context.run(func, *args)
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/users.py", line 51, in update_user_role
    |     log_admin_action(db, str(admin_user.id), "update_user_role", str(user.id), metadata=payload.model_dump())
    |     │                │       │          │                            │    │             │       └ <function BaseModel.model_dump at 0x1030cfce0>
    |     │                │       │          │                            │    │             └ AdminUserRoleUpdate(role=None, admin_level=<AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, permissions={'can_review': True})
    |     │                │       │          │                            │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x105ee7ec0>
    |     │                │       │          │                            └ <app.models.user.User object at 0x106329c50>
    |     │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x105ee7ec0>
    |     │                │       └ <app.models.user.User object at 0x1033bce90>
    |     │                └ <sqlalchemy.orm.session.Session object at 0x106328f90>
    |     └ <function log_admin_action at 0x105fd94e0>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 14, in log_admin_action
    |     entry = AdminLog(admin_id=admin_id, action=action, target_id=target_id, details=json.dumps(metadata or {}))
    |             │                 │                │                 │                  │    │     └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
    |             │                 │                │                 │                  │    └ <function dumps at 0x101472480>
    |             │                 │                │                 │                  └ <module 'json' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py'>
    |             │                 │                │                 └ '917602f6-3926-4bb2-b5d0-15fc927b2aea'
    |             │                 │                └ 'update_user_role'
    |             │                 └ '8efda2b4-82d6-4514-b4a3-5297d9712956'
    |             └ <class 'app.models.admin_log.AdminLog'>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    |     return _default_encoder.encode(obj)
    |            │                │      └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
    |            │                └ <function JSONEncoder.encode at 0x101473420>
    |            └ <json.encoder.JSONEncoder object at 0x1014749d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    |     chunks = self.iterencode(o, _one_shot=True)
    |              │    │          └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
    |              │    └ <function JSONEncoder.iterencode at 0x1014734c0>
    |              └ <json.encoder.JSONEncoder object at 0x1014749d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    |     return _iterencode(o, 0)
    |            │           └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
    |            └ <_json.Encoder object at 0x106680ca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    |     raise TypeError(f'Object of type {o.__class__.__name__} '
    |
    | TypeError: Object of type AdminLevel is not JSON serializable
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x1010f1800>
    └ <Thread(asyncio-portal-1064a8550, started daemon 6213332992)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x1010f14e0>
    └ <Thread(asyncio-portal-1064a8550, started daemon 6213332992)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-1064a8550, started daemon 6213332992)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-1064a8550, started daemon 6213332992)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x106254fe0>
    └ <Thread(asyncio-portal-1064a8550, started daemon 6213332992)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 519, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x102113100>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_core/_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x106022fc0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x10628a660>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2325, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x106335e40>
           │      └ <function Runner.run at 0x102378900>
           └ <asyncio.runners.Runner object at 0x1064a8250>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102376480>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1064a8250>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 641, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1023763e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 608, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102378220>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1936, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1022fc900>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 252, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x10627fc40>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1060e6c00>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1021131a0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1060e6c00>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1021131a0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1061c1a10>
          └ <fastapi.applications.FastAPI object at 0x1060dbf50>
> File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x106264fe0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1021131a0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          │    └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1061c1a10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1033fede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x100e95840>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1064efae0>
    └ <contextlib._GeneratorContextManager object at 0x1064a8150>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x106264c20>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1064a9a90>
                     │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>>
                     └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x1064a9a90>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x106264c20>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type AdminLevel is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x106265d00>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062649a0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>
          └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1033fede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x1062cb640>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1064ee7a0>
    └ <contextlib._GeneratorContextManager object at 0x1064a86d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1062658a0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1064ab0d0>
                     │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>>
                     └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x1064ab0d0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1062658a0>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type AdminLevel is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x106265080>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x106265760>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          │    └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>
          └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1033fede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x1062c8240>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1064ecac0>
    └ <contextlib._GeneratorContextManager object at 0x1062e7490>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1062d1940>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1062e5590>
                     │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>>
                     └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    return await call_next(request)
                 │         └ <starlette.middleware.base._CachedRequest object at 0x1062e5590>
                 └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1062d1940>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type AdminLevel is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1062d27a0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1061c1ad0>
          └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1062d27a0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1061c1110>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1061c1ad0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1062d27a0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          │                            │    │    └ <starlette.requests.Request object at 0x1062cc0d0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1061c1110>
          └ <function wrap_app_handling_exceptions at 0x10486aca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1062d2160>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1062d2160>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1060ec4d0>>
          └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1062d2160>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          │     └ <function Route.handle at 0x10489c4a0>
          └ APIRoute(path='/api/admin/users/{user_id}/role', name='update_user_role', methods=['PATCH'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1062d2160>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          │    └ <function request_response.<locals>.app at 0x106132340>
          └ APIRoute(path='/api/admin/users/{user_id}/role', name='update_user_role', methods=['PATCH'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1062d2160>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          │                            │    └ <starlette.requests.Request object at 0x1062cf6d0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1062d0f40>
          └ <function wrap_app_handling_exceptions at 0x10486aca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1062d1260>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1062d0d60>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/917602f6-3926-4bb2-b5d0-15fc927b2aea/rol...
          └ <function request_response.<locals>.app.<locals>.app at 0x1062d0f40>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1062cf6d0>
                     └ <function get_request_handler.<locals>.app at 0x106132200>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x100a9f740>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x106328f90>, 'admin_user': <app.models.user.User object at 0x1033bce90>, 'u...
                 │                 │         └ <function update_user_role at 0x105fdaca0>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x10614fd50>
                 └ <function run_in_threadpool at 0x10316f2e0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function update_user_role at 0x105fdaca0>, db=<sqlalchemy.orm.session.Session object at 0x106328f90>, admi...
                 │     │         └ <function run_sync at 0x102146a20>
                 │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
                 └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x102145d00>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=TypeError('Object of type AdminLevel is not JSON serializable')>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/users.py", line 51, in update_user_role
    log_admin_action(db, str(admin_user.id), "update_user_role", str(user.id), metadata=payload.model_dump())
    │                │       │          │                            │    │             │       └ <function BaseModel.model_dump at 0x1030cfce0>
    │                │       │          │                            │    │             └ AdminUserRoleUpdate(role=None, admin_level=<AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, permissions={'can_review': True})
    │                │       │          │                            │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x105ee7ec0>
    │                │       │          │                            └ <app.models.user.User object at 0x106329c50>
    │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x105ee7ec0>
    │                │       └ <app.models.user.User object at 0x1033bce90>
    │                └ <sqlalchemy.orm.session.Session object at 0x106328f90>
    └ <function log_admin_action at 0x105fd94e0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 14, in log_admin_action
    entry = AdminLog(admin_id=admin_id, action=action, target_id=target_id, details=json.dumps(metadata or {}))
            │                 │                │                 │                  │    │     └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
            │                 │                │                 │                  │    └ <function dumps at 0x101472480>
            │                 │                │                 │                  └ <module 'json' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py'>
            │                 │                │                 └ '917602f6-3926-4bb2-b5d0-15fc927b2aea'
            │                 │                └ 'update_user_role'
            │                 └ '8efda2b4-82d6-4514-b4a3-5297d9712956'
            └ <class 'app.models.admin_log.AdminLog'>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
           │                └ <function JSONEncoder.encode at 0x101473420>
           └ <json.encoder.JSONEncoder object at 0x1014749d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
             │    └ <function JSONEncoder.iterencode at 0x1014734c0>
             └ <json.encoder.JSONEncoder object at 0x1014749d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
           └ <_json.Encoder object at 0x106680ca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type AdminLevel is not JSON serializable
[2025-10-17 01:25:23] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.47 ms)
[2025-10-17 01:25:23] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.77 ms)
[2025-10-17 01:25:23] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.60 ms)
[2025-10-17 01:25:23] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.57 ms)
[2025-10-17 01:25:23] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.06 ms)
[2025-10-17 01:25:23] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.55 ms)
[2025-10-17 01:25:23] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (3.30 ms)
[2025-10-17 01:25:23] ERROR — Unhandled exception at %s
  + Exception Group Traceback (most recent call last):
  |
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                │     │                      └ <anyio._backends._asyncio.TaskGroup object at 0x1113f0ad0>
  |                │     └ <function create_task_group at 0x102224d60>
  |                └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x110296fc0>
    |           │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x106335da0>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
    |           │    └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1061c1a10>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x1033fede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x11132a840>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x106406c00>
    |     └ <contextlib._GeneratorContextManager object at 0x1113f1bd0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x110297100>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x1113f3890>
    |                      │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>>
    |                      └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x1113f3890>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x110297100>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type CampaignStatus is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x110294ae0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x110294860>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
    |           │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>
    |           └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x1033fede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x11132bd00>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x111977bc0>
    |     └ <contextlib._GeneratorContextManager object at 0x1113f1850>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x106264f40>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x1113f1cd0>
    |                      │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>>
    |                      └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x1113f1cd0>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x106264f40>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type CampaignStatus is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x110297f60>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x110297380>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
    |           │    └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>
    |           └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x1033fede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x11132b780>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x111974ac0>
    |     └ <contextlib._GeneratorContextManager object at 0x1064ad6d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x110297920>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x1113f1310>
    |                      │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>>
    |                      └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    |     return await call_next(request)
    |                  │         └ <starlette.middleware.base._CachedRequest object at 0x1113f1310>
    |                  └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x110297920>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type CampaignStatus is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111979620>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1061c1ad0>
    |           └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111979620>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1061c1110>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x1061c1ad0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111979620>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
    |           │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
    |           │                            │    │    └ <starlette.requests.Request object at 0x1064acf10>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1061c1110>
    |           └ <function wrap_app_handling_exceptions at 0x10486aca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11197a160>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
    |           │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
    |           └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11197a160>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
    |           │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1060ec4d0>>
    |           └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11197a160>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
    |           │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
    |           │     └ <function Route.handle at 0x10489c4a0>
    |           └ APIRoute(path='/api/admin/campaigns/{campaign_id}/status', name='update_campaign_status', methods=['PATCH'])
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11197a160>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
    |           │    └ <function request_response.<locals>.app at 0x1061327a0>
    |           └ APIRoute(path='/api/admin/campaigns/{campaign_id}/status', name='update_campaign_status', methods=['PATCH'])
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11197a160>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
    |           │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
    |           │                            │    └ <starlette.requests.Request object at 0x1064af110>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x111978180>
    |           └ <function wrap_app_handling_exceptions at 0x10486aca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11197b4c0>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
    |           │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x111978180>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    |     response = await func(request)
    |                      │    └ <starlette.requests.Request object at 0x1064af110>
    |                      └ <function get_request_handler.<locals>.app at 0x106132660>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |                          └ <function run_endpoint_function at 0x100a9f740>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |                  │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x1064f97d0>, 'admin_user': <app.models.user.User object at 0x11164e450>, 'c...
    |                  │                 │         └ <function update_campaign_status at 0x105fd98a0>
    |                  │                 └ <fastapi.dependencies.models.Dependant object at 0x10615bb90>
    |                  └ <function run_in_threadpool at 0x10316f2e0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |                  │     │         │        │      └ ()
    |                  │     │         │        └ functools.partial(<function update_campaign_status at 0x105fd98a0>, db=<sqlalchemy.orm.session.Session object at 0x1064f97d0>...
    |                  │     │         └ <function run_sync at 0x102146a20>
    |                  │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
    |                  └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |                  └ <function get_async_backend at 0x102145d00>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    |     return await future
    |                  └ <Future finished exception=TypeError('Object of type CampaignStatus is not JSON serializable')>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    |     result = context.run(func, *args)
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/campaigns.py", line 45, in update_campaign_status
    |     log_admin_action(db, str(admin_user.id), "update_campaign_status", str(campaign_id), metadata=payload.model_dump())
    |     │                │       │          │                                  │                      │       └ <function BaseModel.model_dump at 0x1030cfce0>
    |     │                │       │          │                                  │                      └ AdminCampaignStatusUpdate(status=<CampaignStatus.PAUSED: 'paused'>)
    |     │                │       │          │                                  └ UUID('5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af')
    |     │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x105ee7ec0>
    |     │                │       └ <app.models.user.User object at 0x11164e450>
    |     │                └ <sqlalchemy.orm.session.Session object at 0x1064f97d0>
    |     └ <function log_admin_action at 0x105fd94e0>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 14, in log_admin_action
    |     entry = AdminLog(admin_id=admin_id, action=action, target_id=target_id, details=json.dumps(metadata or {}))
    |             │                 │                │                 │                  │    │     └ {'status': <CampaignStatus.PAUSED: 'paused'>}
    |             │                 │                │                 │                  │    └ <function dumps at 0x101472480>
    |             │                 │                │                 │                  └ <module 'json' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py'>
    |             │                 │                │                 └ '5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af'
    |             │                 │                └ 'update_campaign_status'
    |             │                 └ '420d3fab-3806-43f1-9b82-252a5426e835'
    |             └ <class 'app.models.admin_log.AdminLog'>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    |     return _default_encoder.encode(obj)
    |            │                │      └ {'status': <CampaignStatus.PAUSED: 'paused'>}
    |            │                └ <function JSONEncoder.encode at 0x101473420>
    |            └ <json.encoder.JSONEncoder object at 0x1014749d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    |     chunks = self.iterencode(o, _one_shot=True)
    |              │    │          └ {'status': <CampaignStatus.PAUSED: 'paused'>}
    |              │    └ <function JSONEncoder.iterencode at 0x1014734c0>
    |              └ <json.encoder.JSONEncoder object at 0x1014749d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    |     return _iterencode(o, 0)
    |            │           └ {'status': <CampaignStatus.PAUSED: 'paused'>}
    |            └ <_json.Encoder object at 0x11008afe0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    |     raise TypeError(f'Object of type {o.__class__.__name__} '
    |
    | TypeError: Object of type CampaignStatus is not JSON serializable
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x1010f1800>
    └ <Thread(asyncio-portal-1113f0090, started daemon 6213332992)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x1010f14e0>
    └ <Thread(asyncio-portal-1113f0090, started daemon 6213332992)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-1113f0090, started daemon 6213332992)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-1113f0090, started daemon 6213332992)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x1066ab4c0>
    └ <Thread(asyncio-portal-1113f0090, started daemon 6213332992)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 519, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x102113100>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_core/_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x1066ab740>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x10628a660>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2325, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x1102971a0>
           │      └ <function Runner.run at 0x102378900>
           └ <asyncio.runners.Runner object at 0x1113f1590>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102376480>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1113f1590>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 641, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1023763e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 608, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102378220>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1936, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1022fc900>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 252, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x1062f2f40>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1066ab560>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x106335da0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1066ab560>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x106335da0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1061c1a10>
          └ <fastapi.applications.FastAPI object at 0x1060dbf50>
> File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x110296fc0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x106335da0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          │    └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1061c1a10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1033fede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x11132a840>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x106406c00>
    └ <contextlib._GeneratorContextManager object at 0x1113f1bd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x110297100>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1113f3890>
                     │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>>
                     └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x1113f3890>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x110297100>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type CampaignStatus is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x110294ae0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x110294860>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>
          └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1033fede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x11132bd00>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x111977bc0>
    └ <contextlib._GeneratorContextManager object at 0x1113f1850>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x106264f40>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1113f1cd0>
                     │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>>
                     └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x1113f1cd0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x106264f40>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type CampaignStatus is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x110297f60>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x110297380>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          │    └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>
          └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1033fede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x11132b780>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x111974ac0>
    └ <contextlib._GeneratorContextManager object at 0x1064ad6d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x110297920>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1113f1310>
                     │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>>
                     └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    return await call_next(request)
                 │         └ <starlette.middleware.base._CachedRequest object at 0x1113f1310>
                 └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x110297920>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type CampaignStatus is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111979620>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1061c1ad0>
          └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111979620>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1061c1110>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1061c1ad0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111979620>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          │                            │    │    └ <starlette.requests.Request object at 0x1064acf10>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1061c1110>
          └ <function wrap_app_handling_exceptions at 0x10486aca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11197a160>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11197a160>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1060ec4d0>>
          └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11197a160>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          │     └ <function Route.handle at 0x10489c4a0>
          └ APIRoute(path='/api/admin/campaigns/{campaign_id}/status', name='update_campaign_status', methods=['PATCH'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11197a160>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          │    └ <function request_response.<locals>.app at 0x1061327a0>
          └ APIRoute(path='/api/admin/campaigns/{campaign_id}/status', name='update_campaign_status', methods=['PATCH'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11197a160>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          │                            │    └ <starlette.requests.Request object at 0x1064af110>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x111978180>
          └ <function wrap_app_handling_exceptions at 0x10486aca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x11197b4c0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1119789a0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af...
          └ <function request_response.<locals>.app.<locals>.app at 0x111978180>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1064af110>
                     └ <function get_request_handler.<locals>.app at 0x106132660>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x100a9f740>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x1064f97d0>, 'admin_user': <app.models.user.User object at 0x11164e450>, 'c...
                 │                 │         └ <function update_campaign_status at 0x105fd98a0>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x10615bb90>
                 └ <function run_in_threadpool at 0x10316f2e0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function update_campaign_status at 0x105fd98a0>, db=<sqlalchemy.orm.session.Session object at 0x1064f97d0>...
                 │     │         └ <function run_sync at 0x102146a20>
                 │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
                 └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x102145d00>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=TypeError('Object of type CampaignStatus is not JSON serializable')>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/campaigns.py", line 45, in update_campaign_status
    log_admin_action(db, str(admin_user.id), "update_campaign_status", str(campaign_id), metadata=payload.model_dump())
    │                │       │          │                                  │                      │       └ <function BaseModel.model_dump at 0x1030cfce0>
    │                │       │          │                                  │                      └ AdminCampaignStatusUpdate(status=<CampaignStatus.PAUSED: 'paused'>)
    │                │       │          │                                  └ UUID('5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af')
    │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x105ee7ec0>
    │                │       └ <app.models.user.User object at 0x11164e450>
    │                └ <sqlalchemy.orm.session.Session object at 0x1064f97d0>
    └ <function log_admin_action at 0x105fd94e0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 14, in log_admin_action
    entry = AdminLog(admin_id=admin_id, action=action, target_id=target_id, details=json.dumps(metadata or {}))
            │                 │                │                 │                  │    │     └ {'status': <CampaignStatus.PAUSED: 'paused'>}
            │                 │                │                 │                  │    └ <function dumps at 0x101472480>
            │                 │                │                 │                  └ <module 'json' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py'>
            │                 │                │                 └ '5c3e5c31-24c6-4bc3-b7aa-05eb79ed32af'
            │                 │                └ 'update_campaign_status'
            │                 └ '420d3fab-3806-43f1-9b82-252a5426e835'
            └ <class 'app.models.admin_log.AdminLog'>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'status': <CampaignStatus.PAUSED: 'paused'>}
           │                └ <function JSONEncoder.encode at 0x101473420>
           └ <json.encoder.JSONEncoder object at 0x1014749d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'status': <CampaignStatus.PAUSED: 'paused'>}
             │    └ <function JSONEncoder.iterencode at 0x1014734c0>
             └ <json.encoder.JSONEncoder object at 0x1014749d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'status': <CampaignStatus.PAUSED: 'paused'>}
           └ <_json.Encoder object at 0x11008afe0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type CampaignStatus is not JSON serializable
[2025-10-17 01:25:23] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.30 ms)
[2025-10-17 01:25:23] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.87 ms)
[2025-10-17 01:25:23] ERROR — Unhandled exception at %s
Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1815, in _execute_context
    context = constructor(
              └ <bound method DefaultExecutionContext._init_compiled of <class 'sqlalchemy.dialects.sqlite.base.SQLiteExecutionContext'>>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 1457, in _init_compiled
    l_param: List[Any] = [
             │    └ typing.Any
             └ typing.List
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 1459, in <listcomp>
    flattened_processors[key](compiled_params[key])
    │                    │    │               └ 'admin_id'
    │                    │    └ {'id': UUID('3b8ab761-0a90-41fd-a2e9-3e30ab3e8c9a'), 'admin_id': '54a8a6e1-690d-4ea6-8ebd-65ff77352ca5', 'action': 'view_stat...
    │                    └ 'admin_id'
    └ {'id': <function Uuid.bind_processor.<locals>.process at 0x11191ede0>, 'admin_id': <function Uuid.bind_processor.<locals>.pro...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 3608, in process
    value = value.hex
            └ '54a8a6e1-690d-4ea6-8ebd-65ff77352ca5'

AttributeError: 'str' object has no attribute 'hex'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x1010f1800>
    └ <Thread(asyncio-portal-1107b8690, started daemon 6213332992)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x1010f14e0>
    └ <Thread(asyncio-portal-1107b8690, started daemon 6213332992)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-1107b8690, started daemon 6213332992)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-1107b8690, started daemon 6213332992)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x1062d2160>
    └ <Thread(asyncio-portal-1107b8690, started daemon 6213332992)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 519, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x102113100>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_core/_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x1062d0f40>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x10628a660>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2325, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x1062d1940>
           │      └ <function Runner.run at 0x102378900>
           └ <asyncio.runners.Runner object at 0x1107bb350>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x102376480>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x1107bb350>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 641, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1023763e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 608, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x102378220>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1936, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x1022fc900>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 252, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x1061bf640>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1102972e0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x106264c20>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1102972e0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x106264c20>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1061c1a10>
          └ <fastapi.applications.FastAPI object at 0x1060dbf50>
> File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1119796c0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x106264c20>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1061c1a10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1033fede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x11150c700>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [StatementError("(builtins.AttributeError) 'str' object has no attribute 'h...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1064ef3e0>
    └ <contextlib._GeneratorContextManager object at 0x111527ed0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x11197be20>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x111525550>
                     │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>>
                     └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x111525550>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x11197be20>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ StatementError("(builtins.AttributeError) 'str' object has no attribute 'hex'")
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1066abf60>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x11197bec0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>
          └ <app.core.middleware.AdminActionMiddleware object at 0x105eaa050>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1033fede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x11150c940>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [StatementError("(builtins.AttributeError) 'str' object has no attribute 'h...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x11196fae0>
    └ <contextlib._GeneratorContextManager object at 0x111527ad0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x106265580>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1115257d0>
                     │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>>
                     └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x1115257d0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x106265580>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ StatementError("(builtins.AttributeError) 'str' object has no attribute 'hex'")
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111934900>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111936ac0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>
          └ <app.core.middleware.RequestLoggerMiddleware object at 0x1061c0850>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1033fede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x11150c680>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [StatementError("(builtins.AttributeError) 'str' object has no attribute 'h...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1064073e0>
    └ <contextlib._GeneratorContextManager object at 0x111526c10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x111936e80>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1115264d0>
                     │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>>
                     └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    return await call_next(request)
                 │         └ <starlette.middleware.base._CachedRequest object at 0x1115264d0>
                 └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x111936e80>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ StatementError("(builtins.AttributeError) 'str' object has no attribute 'hex'")
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111935e40>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111936480>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1061c1ad0>
          └ <app.core.middleware.RateLimitMiddleware object at 0x105bbfd50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111935e40>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111936480>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1061c1110>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1061c1ad0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111935e40>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111936480>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │                            │    │    └ <starlette.requests.Request object at 0x111527010>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x1061c1110>
          └ <function wrap_app_handling_exceptions at 0x10486aca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1119368e0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111936480>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1119368e0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111936480>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1060ec4d0>>
          └ <fastapi.routing.APIRouter object at 0x1060ec4d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1119368e0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111936480>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │     └ <function Route.handle at 0x10489c4a0>
          └ APIRoute(path='/api/admin/statistics', name='get_statistics', methods=['GET'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1119368e0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111936480>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <function request_response.<locals>.app at 0x106132b60>
          └ APIRoute(path='/api/admin/statistics', name='get_statistics', methods=['GET'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1119368e0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111936480>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │                            │    └ <starlette.requests.Request object at 0x111524590>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x111937600>
          └ <function wrap_app_handling_exceptions at 0x10486aca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111937100>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111936480>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          └ <function request_response.<locals>.app.<locals>.app at 0x111937600>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x111524590>
                     └ <function get_request_handler.<locals>.app at 0x106132ac0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x100a9f740>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x111524a90>, 'admin_user': <app.models.user.User object at 0x111734610>}
                 │                 │         └ <function get_statistics at 0x105fda020>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x106166f10>
                 └ <function run_in_threadpool at 0x10316f2e0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function get_statistics at 0x105fda020>, db=<sqlalchemy.orm.session.Session object at 0x111524a90>, admin_...
                 │     │         └ <function run_sync at 0x102146a20>
                 │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
                 └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x102145d00>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=StatementError("(builtins.AttributeError) 'str' object has no attribute 'hex'")>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/statistics.py", line 26, in get_statistics
    log_admin_action(db, str(admin_user.id), "view_statistics", None)
    │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x105ee7ec0>
    │                │       └ <app.models.user.User object at 0x111734610>
    │                └ <sqlalchemy.orm.session.Session object at 0x111524a90>
    └ <function log_admin_action at 0x105fd94e0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 16, in log_admin_action
    db.commit()
    │  └ <function Session.commit at 0x1057c34c0>
    └ <sqlalchemy.orm.session.Session object at 0x111524a90>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2017, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x1057c25c0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x1119c9bd0>
  File "<string>", line 2, in commit
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x1119c9bd0>
                └ <function SessionTransaction.commit at 0x1057c23e0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1302, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x1057c22a0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x1119c9bd0>
  File "<string>", line 2, in _prepare_impl
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x1119c9bd0>
                └ <function SessionTransaction._prepare_impl at 0x1057c2200>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1277, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x1057de3e0>
    │    └ <sqlalchemy.orm.session.Session object at 0x111524a90>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x1119c9bd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4341, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x1057de5c0>
    └ <sqlalchemy.orm.session.Session object at 0x111524a90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4476, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/ut...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x11150fb40>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ StatementError("(builtins.AttributeError) 'str' object has no attribute 'hex'")
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4437, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x1057aee80>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x1100c0650>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x1100c0650>
    │   └ <function SaveUpdateAll.execute at 0x1057af9c0>
    └ SaveUpdateAll(Mapper[AdminLog(admin_logs)])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x10570a160>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sq...
    │    └ <module 'sqlalchemy.util.preloaded' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sql...
    └ <module 'sqlalchemy.util' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/ut...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x105795a80>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x1053454e0>
             └ <sqlalchemy.engine.base.Connection object at 0x111526890>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x1100c2610>>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x105345800>
           └ <sqlalchemy.engine.base.Connection object at 0x111526890>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x1053459e0>
          └ <sqlalchemy.engine.base.Connection object at 0x111526890>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x105345d00>
    └ <sqlalchemy.engine.base.Connection object at 0x111526890>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2353, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ AttributeError("'str' object has no attribute 'hex'")
          │                    │              └ (<class 'AttributeError'>, AttributeError("'str' object has no attribute 'hex'"), <traceback object at 0x11150f200>)
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ StatementError("(builtins.AttributeError) 'str' object has no attribute 'hex'")
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1815, in _execute_context
    context = constructor(
              └ <bound method DefaultExecutionContext._init_compiled of <class 'sqlalchemy.dialects.sqlite.base.SQLiteExecutionContext'>>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 1457, in _init_compiled
    l_param: List[Any] = [
             │    └ typing.Any
             └ typing.List
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 1459, in <listcomp>
    flattened_processors[key](compiled_params[key])
    │                    │    │               └ 'admin_id'
    │                    │    └ {'id': UUID('3b8ab761-0a90-41fd-a2e9-3e30ab3e8c9a'), 'admin_id': '54a8a6e1-690d-4ea6-8ebd-65ff77352ca5', 'action': 'view_stat...
    │                    └ 'admin_id'
    └ {'id': <function Uuid.bind_processor.<locals>.process at 0x11191ede0>, 'admin_id': <function Uuid.bind_processor.<locals>.pro...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 3608, in process
    value = value.hex
            └ '54a8a6e1-690d-4ea6-8ebd-65ff77352ca5'

sqlalchemy.exc.StatementError: (builtins.AttributeError) 'str' object has no attribute 'hex'
[SQL: INSERT INTO admin_logs (id, admin_id, action, target_id, details) VALUES (?, ?, ?, ?, ?) RETURNING created_at]
[parameters: [{'admin_id': '54a8a6e1-690d-4ea6-8ebd-65ff77352ca5', 'action': 'view_statistics', 'details': '{}', 'target_id': None}]]
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (20.02 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (2.12 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] GET /api/admin/users from unknown -> 403 (1.86 ms)
[2025-10-17 01:25:35] INFO — admin_action method=GET path=/api/admin/users status=403 admin_id=2e8d7edb-14b2-4c65-973d-1aae672e7e16
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (3.32 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.48 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] GET /api/admin/users from unknown -> 200 (1.94 ms)
[2025-10-17 01:25:35] INFO — admin_action method=GET path=/api/admin/users status=200 admin_id=a984925f-3306-46f2-a0dd-011c6403fffd
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.43 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.45 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (1.81 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.37 ms)
[2025-10-17 01:25:35] ERROR — Unhandled exception at %s
  + Exception Group Traceback (most recent call last):
  |
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                │     │                      └ <anyio._backends._asyncio.TaskGroup object at 0x104672e90>
  |                │     └ <function create_task_group at 0x101fa0d60>
  |                └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1045047c0>
    |           │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1044cd4e0>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
    |           │    └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x104525310>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x10271ede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x104601940>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x104519000>
    |     └ <contextlib._GeneratorContextManager object at 0x104672b50>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x104504e00>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x104672d50>
    |                      │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x104525390>>
    |                      └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x104672d50>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x104504e00>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type AdminLevel is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x104505bc0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1045054e0>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
    |           │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>
    |           └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x10271ede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x104602200>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x10460aa40>
    |     └ <contextlib._GeneratorContextManager object at 0x104671550>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x104506340>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x1046714d0>
    |                      │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>>
    |                      └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x1046714d0>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x104506340>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type AdminLevel is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x104506660>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1045065c0>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
    |           │    └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>
    |           └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x10271ede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x104601440>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x10460b760>
    |     └ <contextlib._GeneratorContextManager object at 0x104671190>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x104506d40>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x104671d10>
    |                      │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>>
    |                      └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    |     return await call_next(request)
    |                  │         └ <starlette.middleware.base._CachedRequest object at 0x104671d10>
    |                  └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x104506d40>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type AdminLevel is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x104504b80>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x104524990>
    |           └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x104504b80>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x104524a90>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x104524990>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x104504b80>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
    |           │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
    |           │                            │    │    └ <starlette.requests.Request object at 0x1046735d0>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x10430be10>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x104524a90>
    |           └ <function wrap_app_handling_exceptions at 0x10278eca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1045063e0>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
    |           │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
    |           └ <fastapi.routing.APIRouter object at 0x10430be10>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1045063e0>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
    |           │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x10430be10>>
    |           └ <fastapi.routing.APIRouter object at 0x10430be10>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1045063e0>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
    |           │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
    |           │     └ <function Route.handle at 0x1027bc4a0>
    |           └ APIRoute(path='/api/admin/users/{user_id}/role', name='update_user_role', methods=['PATCH'])
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1045063e0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
    |           │    └ <function request_response.<locals>.app at 0x104362340>
    |           └ APIRoute(path='/api/admin/users/{user_id}/role', name='update_user_role', methods=['PATCH'])
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1045063e0>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
    |           │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
    |           │                            │    └ <starlette.requests.Request object at 0x104673510>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x1045071a0>
    |           └ <function wrap_app_handling_exceptions at 0x10278eca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x104506ac0>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
    |           │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x1045071a0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    |     response = await func(request)
    |                      │    └ <starlette.requests.Request object at 0x104673510>
    |                      └ <function get_request_handler.<locals>.app at 0x104362200>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |                          └ <function run_endpoint_function at 0x10091b740>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |                  │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x104600450>, 'admin_user': <app.models.user.User object at 0x10453a990>, 'u...
    |                  │                 │         └ <function update_user_role at 0x10420eca0>
    |                  │                 └ <fastapi.dependencies.models.Dependant object at 0x104383450>
    |                  └ <function run_in_threadpool at 0x10258f2e0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |                  │     │         │        │      └ ()
    |                  │     │         │        └ functools.partial(<function update_user_role at 0x10420eca0>, db=<sqlalchemy.orm.session.Session object at 0x104600450>, admi...
    |                  │     │         └ <function run_sync at 0x101ec6a20>
    |                  │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
    |                  └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |                  └ <function get_async_backend at 0x101ec5d00>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    |     return await future
    |                  └ <Future finished exception=TypeError('Object of type AdminLevel is not JSON serializable')>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    |     result = context.run(func, *args)
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/users.py", line 51, in update_user_role
    |     log_admin_action(db, str(admin_user.id), "update_user_role", str(user.id), metadata=payload.model_dump())
    |     │                │       │          │                            │    │             │       └ <function BaseModel.model_dump at 0x1024efce0>
    |     │                │       │          │                            │    │             └ AdminUserRoleUpdate(role=None, admin_level=<AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, permissions={'can_review': True})
    |     │                │       │          │                            │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x103f6fec0>
    |     │                │       │          │                            └ <app.models.user.User object at 0x104672550>
    |     │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x103f6fec0>
    |     │                │       └ <app.models.user.User object at 0x10453a990>
    |     │                └ <sqlalchemy.orm.session.Session object at 0x104600450>
    |     └ <function log_admin_action at 0x10420d4e0>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 14, in log_admin_action
    |     entry = AdminLog(admin_id=admin_id, action=action, target_id=target_id, details=json.dumps(metadata or {}))
    |             │                 │                │                 │                  │    │     └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
    |             │                 │                │                 │                  │    └ <function dumps at 0x101306480>
    |             │                 │                │                 │                  └ <module 'json' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py'>
    |             │                 │                │                 └ '95581294-1f8c-45e3-aa0e-4654c6d4296b'
    |             │                 │                └ 'update_user_role'
    |             │                 └ 'bfa87e79-bb92-42ae-a12f-33e9124f7545'
    |             └ <class 'app.models.admin_log.AdminLog'>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    |     return _default_encoder.encode(obj)
    |            │                │      └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
    |            │                └ <function JSONEncoder.encode at 0x101307420>
    |            └ <json.encoder.JSONEncoder object at 0x101303fd0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    |     chunks = self.iterencode(o, _one_shot=True)
    |              │    │          └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
    |              │    └ <function JSONEncoder.iterencode at 0x1013074c0>
    |              └ <json.encoder.JSONEncoder object at 0x101303fd0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    |     return _iterencode(o, 0)
    |            │           └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
    |            └ <_json.Encoder object at 0x1045b68c0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    |     raise TypeError(f'Object of type {o.__class__.__name__} '
    |
    | TypeError: Object of type AdminLevel is not JSON serializable
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x100ee9800>
    └ <Thread(asyncio-portal-10453a310, started daemon 6215430144)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x100ee94e0>
    └ <Thread(asyncio-portal-10453a310, started daemon 6215430144)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-10453a310, started daemon 6215430144)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-10453a310, started daemon 6215430144)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x10456be20>
    └ <Thread(asyncio-portal-10453a310, started daemon 6215430144)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 519, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x101e8f100>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_core/_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x104316c00>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x1044ca700>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2325, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x104569d00>
           │      └ <function Runner.run at 0x1020f4900>
           └ <asyncio.runners.Runner object at 0x10453ad90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1020f2480>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10453ad90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 641, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1020f23e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 608, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1020f4220>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1936, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102078900>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 252, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x1043ef940>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1044cc5e0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1044cd4e0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1044cc5e0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1044cd4e0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x104525310>
          └ <fastapi.applications.FastAPI object at 0x10401a450>
> File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1045047c0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1044cd4e0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          │    └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x104525310>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x10271ede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x104601940>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x104519000>
    └ <contextlib._GeneratorContextManager object at 0x104672b50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x104504e00>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x104672d50>
                     │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x104525390>>
                     └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x104672d50>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x104504e00>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type AdminLevel is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x104505bc0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1045054e0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>
          └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x10271ede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x104602200>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x10460aa40>
    └ <contextlib._GeneratorContextManager object at 0x104671550>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x104506340>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1046714d0>
                     │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>>
                     └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x1046714d0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x104506340>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type AdminLevel is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x104506660>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1045065c0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          │    └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>
          └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x10271ede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x104601440>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x10460b760>
    └ <contextlib._GeneratorContextManager object at 0x104671190>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x104506d40>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x104671d10>
                     │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>>
                     └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    return await call_next(request)
                 │         └ <starlette.middleware.base._CachedRequest object at 0x104671d10>
                 └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x104506d40>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type AdminLevel is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x104504b80>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x104524990>
          └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x104504b80>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x104524a90>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x104524990>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x104504b80>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          │                            │    │    └ <starlette.requests.Request object at 0x1046735d0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x10430be10>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x104524a90>
          └ <function wrap_app_handling_exceptions at 0x10278eca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1045063e0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          └ <fastapi.routing.APIRouter object at 0x10430be10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1045063e0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x10430be10>>
          └ <fastapi.routing.APIRouter object at 0x10430be10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1045063e0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          │     └ <function Route.handle at 0x1027bc4a0>
          └ APIRoute(path='/api/admin/users/{user_id}/role', name='update_user_role', methods=['PATCH'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1045063e0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          │    └ <function request_response.<locals>.app at 0x104362340>
          └ APIRoute(path='/api/admin/users/{user_id}/role', name='update_user_role', methods=['PATCH'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1045063e0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          │                            │    └ <starlette.requests.Request object at 0x104673510>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1045071a0>
          └ <function wrap_app_handling_exceptions at 0x10278eca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x104506ac0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104504720>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/95581294-1f8c-45e3-aa0e-4654c6d4296b/rol...
          └ <function request_response.<locals>.app.<locals>.app at 0x1045071a0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x104673510>
                     └ <function get_request_handler.<locals>.app at 0x104362200>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10091b740>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x104600450>, 'admin_user': <app.models.user.User object at 0x10453a990>, 'u...
                 │                 │         └ <function update_user_role at 0x10420eca0>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x104383450>
                 └ <function run_in_threadpool at 0x10258f2e0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function update_user_role at 0x10420eca0>, db=<sqlalchemy.orm.session.Session object at 0x104600450>, admi...
                 │     │         └ <function run_sync at 0x101ec6a20>
                 │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
                 └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x101ec5d00>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=TypeError('Object of type AdminLevel is not JSON serializable')>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/users.py", line 51, in update_user_role
    log_admin_action(db, str(admin_user.id), "update_user_role", str(user.id), metadata=payload.model_dump())
    │                │       │          │                            │    │             │       └ <function BaseModel.model_dump at 0x1024efce0>
    │                │       │          │                            │    │             └ AdminUserRoleUpdate(role=None, admin_level=<AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, permissions={'can_review': True})
    │                │       │          │                            │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x103f6fec0>
    │                │       │          │                            └ <app.models.user.User object at 0x104672550>
    │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x103f6fec0>
    │                │       └ <app.models.user.User object at 0x10453a990>
    │                └ <sqlalchemy.orm.session.Session object at 0x104600450>
    └ <function log_admin_action at 0x10420d4e0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 14, in log_admin_action
    entry = AdminLog(admin_id=admin_id, action=action, target_id=target_id, details=json.dumps(metadata or {}))
            │                 │                │                 │                  │    │     └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
            │                 │                │                 │                  │    └ <function dumps at 0x101306480>
            │                 │                │                 │                  └ <module 'json' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py'>
            │                 │                │                 └ '95581294-1f8c-45e3-aa0e-4654c6d4296b'
            │                 │                └ 'update_user_role'
            │                 └ 'bfa87e79-bb92-42ae-a12f-33e9124f7545'
            └ <class 'app.models.admin_log.AdminLog'>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
           │                └ <function JSONEncoder.encode at 0x101307420>
           └ <json.encoder.JSONEncoder object at 0x101303fd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
             │    └ <function JSONEncoder.iterencode at 0x1013074c0>
             └ <json.encoder.JSONEncoder object at 0x101303fd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
           └ <_json.Encoder object at 0x1045b68c0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type AdminLevel is not JSON serializable
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.29 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.96 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (1.98 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.33 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (1.87 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.70 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (3.20 ms)
[2025-10-17 01:25:35] ERROR — Unhandled exception at %s
  + Exception Group Traceback (most recent call last):
  |
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                │     │                      └ <anyio._backends._asyncio.TaskGroup object at 0x10528b350>
  |                │     └ <function create_task_group at 0x101fa0d60>
  |                └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1059445e0>
    |           │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1048e7600>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
    |           │    └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x104525310>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x10271ede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x1050b6e40>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x105940900>
    |     └ <contextlib._GeneratorContextManager object at 0x105288b90>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x105944860>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x10528b850>
    |                      │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x104525390>>
    |                      └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x10528b850>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x105944860>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type CampaignStatus is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1059447c0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105944a40>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
    |           │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>
    |           └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x10271ede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x1050b6400>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x105940580>
    |     └ <contextlib._GeneratorContextManager object at 0x105289e10>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x105946020>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x10528bc10>
    |                      │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>>
    |                      └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x10528bc10>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x105946020>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type CampaignStatus is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x105944040>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945f80>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
    |           │    └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>
    |           └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x10271ede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x1050b7480>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x1059389e0>
    |     └ <contextlib._GeneratorContextManager object at 0x1052894d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1059463e0>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x10528bfd0>
    |                      │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>>
    |                      └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    |     return await call_next(request)
    |                  │         └ <starlette.middleware.base._CachedRequest object at 0x10528bfd0>
    |                  └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1059463e0>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type CampaignStatus is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x105944c20>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x104524990>
    |           └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x105944c20>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x104524a90>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x104524990>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x105944c20>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
    |           │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
    |           │                            │    │    └ <starlette.requests.Request object at 0x105090890>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x10430be10>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x104524a90>
    |           └ <function wrap_app_handling_exceptions at 0x10278eca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105944540>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
    |           │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
    |           └ <fastapi.routing.APIRouter object at 0x10430be10>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105944540>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
    |           │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x10430be10>>
    |           └ <fastapi.routing.APIRouter object at 0x10430be10>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105944540>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
    |           │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
    |           │     └ <function Route.handle at 0x1027bc4a0>
    |           └ APIRoute(path='/api/admin/campaigns/{campaign_id}/status', name='update_campaign_status', methods=['PATCH'])
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105944540>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
    |           │    └ <function request_response.<locals>.app at 0x1043627a0>
    |           └ APIRoute(path='/api/admin/campaigns/{campaign_id}/status', name='update_campaign_status', methods=['PATCH'])
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105944540>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
    |           │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
    |           │                            │    └ <starlette.requests.Request object at 0x105090a90>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x105944d60>
    |           └ <function wrap_app_handling_exceptions at 0x10278eca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105945e40>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
    |           │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x105944d60>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    |     response = await func(request)
    |                      │    └ <starlette.requests.Request object at 0x105090a90>
    |                      └ <function get_request_handler.<locals>.app at 0x104362660>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |                          └ <function run_endpoint_function at 0x10091b740>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |                  │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x105092150>, 'admin_user': <app.models.user.User object at 0x105289310>, 'c...
    |                  │                 │         └ <function update_campaign_status at 0x10420d8a0>
    |                  │                 └ <fastapi.dependencies.models.Dependant object at 0x10438f8d0>
    |                  └ <function run_in_threadpool at 0x10258f2e0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |                  │     │         │        │      └ ()
    |                  │     │         │        └ functools.partial(<function update_campaign_status at 0x10420d8a0>, db=<sqlalchemy.orm.session.Session object at 0x105092150>...
    |                  │     │         └ <function run_sync at 0x101ec6a20>
    |                  │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
    |                  └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |                  └ <function get_async_backend at 0x101ec5d00>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    |     return await future
    |                  └ <Future finished exception=TypeError('Object of type CampaignStatus is not JSON serializable')>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    |     result = context.run(func, *args)
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/campaigns.py", line 45, in update_campaign_status
    |     log_admin_action(db, str(admin_user.id), "update_campaign_status", str(campaign_id), metadata=payload.model_dump())
    |     │                │       │          │                                  │                      │       └ <function BaseModel.model_dump at 0x1024efce0>
    |     │                │       │          │                                  │                      └ AdminCampaignStatusUpdate(status=<CampaignStatus.PAUSED: 'paused'>)
    |     │                │       │          │                                  └ UUID('29353ef1-ebb6-4265-9ae4-af06ccd780ee')
    |     │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x103f6fec0>
    |     │                │       └ <app.models.user.User object at 0x105289310>
    |     │                └ <sqlalchemy.orm.session.Session object at 0x105092150>
    |     └ <function log_admin_action at 0x10420d4e0>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 14, in log_admin_action
    |     entry = AdminLog(admin_id=admin_id, action=action, target_id=target_id, details=json.dumps(metadata or {}))
    |             │                 │                │                 │                  │    │     └ {'status': <CampaignStatus.PAUSED: 'paused'>}
    |             │                 │                │                 │                  │    └ <function dumps at 0x101306480>
    |             │                 │                │                 │                  └ <module 'json' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py'>
    |             │                 │                │                 └ '29353ef1-ebb6-4265-9ae4-af06ccd780ee'
    |             │                 │                └ 'update_campaign_status'
    |             │                 └ '73c9a008-5f3d-49b6-bd91-1714cbe72897'
    |             └ <class 'app.models.admin_log.AdminLog'>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    |     return _default_encoder.encode(obj)
    |            │                │      └ {'status': <CampaignStatus.PAUSED: 'paused'>}
    |            │                └ <function JSONEncoder.encode at 0x101307420>
    |            └ <json.encoder.JSONEncoder object at 0x101303fd0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    |     chunks = self.iterencode(o, _one_shot=True)
    |              │    │          └ {'status': <CampaignStatus.PAUSED: 'paused'>}
    |              │    └ <function JSONEncoder.iterencode at 0x1013074c0>
    |              └ <json.encoder.JSONEncoder object at 0x101303fd0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    |     return _iterencode(o, 0)
    |            │           └ {'status': <CampaignStatus.PAUSED: 'paused'>}
    |            └ <_json.Encoder object at 0x104a54640>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    |     raise TypeError(f'Object of type {o.__class__.__name__} '
    |
    | TypeError: Object of type CampaignStatus is not JSON serializable
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x100ee9800>
    └ <Thread(asyncio-portal-105288890, started daemon 6215430144)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x100ee94e0>
    └ <Thread(asyncio-portal-105288890, started daemon 6215430144)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-105288890, started daemon 6215430144)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-105288890, started daemon 6215430144)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x1048e6020>
    └ <Thread(asyncio-portal-105288890, started daemon 6215430144)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 519, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x101e8f100>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_core/_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x1048e7420>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x1044ca700>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2325, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x1048e7e20>
           │      └ <function Runner.run at 0x1020f4900>
           └ <asyncio.runners.Runner object at 0x105288790>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1020f2480>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x105288790>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 641, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1020f23e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 608, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1020f4220>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1936, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102078900>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 252, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x10454d140>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1048e7060>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1048e7600>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1048e7060>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1048e7600>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x104525310>
          └ <fastapi.applications.FastAPI object at 0x10401a450>
> File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1059445e0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1048e7600>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          │    └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x104525310>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x10271ede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x1050b6e40>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x105940900>
    └ <contextlib._GeneratorContextManager object at 0x105288b90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x105944860>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x10528b850>
                     │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x104525390>>
                     └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x10528b850>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x105944860>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type CampaignStatus is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1059447c0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105944a40>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>
          └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x10271ede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x1050b6400>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x105940580>
    └ <contextlib._GeneratorContextManager object at 0x105289e10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x105946020>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x10528bc10>
                     │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>>
                     └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x10528bc10>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x105946020>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type CampaignStatus is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x105944040>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945f80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          │    └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>
          └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x10271ede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x1050b7480>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1059389e0>
    └ <contextlib._GeneratorContextManager object at 0x1052894d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1059463e0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x10528bfd0>
                     │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>>
                     └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    return await call_next(request)
                 │         └ <starlette.middleware.base._CachedRequest object at 0x10528bfd0>
                 └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1059463e0>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type CampaignStatus is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x105944c20>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x104524990>
          └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x105944c20>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x104524a90>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x104524990>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x105944c20>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          │                            │    │    └ <starlette.requests.Request object at 0x105090890>
          │                            │    └ <fastapi.routing.APIRouter object at 0x10430be10>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x104524a90>
          └ <function wrap_app_handling_exceptions at 0x10278eca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105944540>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          └ <fastapi.routing.APIRouter object at 0x10430be10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105944540>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x10430be10>>
          └ <fastapi.routing.APIRouter object at 0x10430be10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105944540>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          │     └ <function Route.handle at 0x1027bc4a0>
          └ APIRoute(path='/api/admin/campaigns/{campaign_id}/status', name='update_campaign_status', methods=['PATCH'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105944540>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          │    └ <function request_response.<locals>.app at 0x1043627a0>
          └ APIRoute(path='/api/admin/campaigns/{campaign_id}/status', name='update_campaign_status', methods=['PATCH'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105944540>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          │                            │    └ <starlette.requests.Request object at 0x105090a90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x105944d60>
          └ <function wrap_app_handling_exceptions at 0x10278eca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105945e40>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105945800>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/29353ef1-ebb6-4265-9ae4-af06ccd780ee...
          └ <function request_response.<locals>.app.<locals>.app at 0x105944d60>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x105090a90>
                     └ <function get_request_handler.<locals>.app at 0x104362660>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10091b740>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x105092150>, 'admin_user': <app.models.user.User object at 0x105289310>, 'c...
                 │                 │         └ <function update_campaign_status at 0x10420d8a0>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x10438f8d0>
                 └ <function run_in_threadpool at 0x10258f2e0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function update_campaign_status at 0x10420d8a0>, db=<sqlalchemy.orm.session.Session object at 0x105092150>...
                 │     │         └ <function run_sync at 0x101ec6a20>
                 │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
                 └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x101ec5d00>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=TypeError('Object of type CampaignStatus is not JSON serializable')>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/campaigns.py", line 45, in update_campaign_status
    log_admin_action(db, str(admin_user.id), "update_campaign_status", str(campaign_id), metadata=payload.model_dump())
    │                │       │          │                                  │                      │       └ <function BaseModel.model_dump at 0x1024efce0>
    │                │       │          │                                  │                      └ AdminCampaignStatusUpdate(status=<CampaignStatus.PAUSED: 'paused'>)
    │                │       │          │                                  └ UUID('29353ef1-ebb6-4265-9ae4-af06ccd780ee')
    │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x103f6fec0>
    │                │       └ <app.models.user.User object at 0x105289310>
    │                └ <sqlalchemy.orm.session.Session object at 0x105092150>
    └ <function log_admin_action at 0x10420d4e0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 14, in log_admin_action
    entry = AdminLog(admin_id=admin_id, action=action, target_id=target_id, details=json.dumps(metadata or {}))
            │                 │                │                 │                  │    │     └ {'status': <CampaignStatus.PAUSED: 'paused'>}
            │                 │                │                 │                  │    └ <function dumps at 0x101306480>
            │                 │                │                 │                  └ <module 'json' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py'>
            │                 │                │                 └ '29353ef1-ebb6-4265-9ae4-af06ccd780ee'
            │                 │                └ 'update_campaign_status'
            │                 └ '73c9a008-5f3d-49b6-bd91-1714cbe72897'
            └ <class 'app.models.admin_log.AdminLog'>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'status': <CampaignStatus.PAUSED: 'paused'>}
           │                └ <function JSONEncoder.encode at 0x101307420>
           └ <json.encoder.JSONEncoder object at 0x101303fd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'status': <CampaignStatus.PAUSED: 'paused'>}
             │    └ <function JSONEncoder.iterencode at 0x1013074c0>
             └ <json.encoder.JSONEncoder object at 0x101303fd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'status': <CampaignStatus.PAUSED: 'paused'>}
           └ <_json.Encoder object at 0x104a54640>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type CampaignStatus is not JSON serializable
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.26 ms)
[2025-10-17 01:25:35] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.68 ms)
[2025-10-17 01:25:35] ERROR — Unhandled exception at %s
Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1815, in _execute_context
    context = constructor(
              └ <bound method DefaultExecutionContext._init_compiled of <class 'sqlalchemy.dialects.sqlite.base.SQLiteExecutionContext'>>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 1457, in _init_compiled
    l_param: List[Any] = [
             │    └ typing.Any
             └ typing.List
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 1459, in <listcomp>
    flattened_processors[key](compiled_params[key])
    │                    │    │               └ 'admin_id'
    │                    │    └ {'id': UUID('5fe7ff29-7099-4164-8147-062f4b103e9a'), 'admin_id': '1c65f61f-e140-4240-b2f4-3196e2057e25', 'action': 'view_stat...
    │                    └ 'admin_id'
    └ {'id': <function Uuid.bind_processor.<locals>.process at 0x1058d6c00>, 'admin_id': <function Uuid.bind_processor.<locals>.pro...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 3608, in process
    value = value.hex
            └ '1c65f61f-e140-4240-b2f4-3196e2057e25'

AttributeError: 'str' object has no attribute 'hex'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x100ee9800>
    └ <Thread(asyncio-portal-105838e50, started daemon 6215430144)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x100ee94e0>
    └ <Thread(asyncio-portal-105838e50, started daemon 6215430144)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-105838e50, started daemon 6215430144)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-105838e50, started daemon 6215430144)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x105947c40>
    └ <Thread(asyncio-portal-105838e50, started daemon 6215430144)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 519, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x101e8f100>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_core/_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x105947240>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x1044ca700>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2325, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x1048e7f60>
           │      └ <function Runner.run at 0x1020f4900>
           └ <asyncio.runners.Runner object at 0x10583b210>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1020f2480>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x10583b210>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 641, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1020f23e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 608, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1020f4220>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1936, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x102078900>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 252, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x1043ed740>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1059440e0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x10262c400>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1059440e0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x10262c400>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x104525310>
          └ <fastapi.applications.FastAPI object at 0x10401a450>
> File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x104504e00>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x10262c400>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x104525310>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x10271ede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x1058040c0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [StatementError("(builtins.AttributeError) 'str' object has no attribute 'h...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x105940200>
    └ <contextlib._GeneratorContextManager object at 0x1053f79d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1045047c0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1053f7950>
                     │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x104525390>>
                     └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x1053f7950>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1045047c0>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ StatementError("(builtins.AttributeError) 'str' object has no attribute 'hex'")
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x104505300>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1045060c0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>
          └ <app.core.middleware.AdminActionMiddleware object at 0x104525390>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x10271ede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x105805b40>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [StatementError("(builtins.AttributeError) 'str' object has no attribute 'h...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x10451b680>
    └ <contextlib._GeneratorContextManager object at 0x1053f7850>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1044cd1c0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1053f7750>
                     │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>>
                     └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x1053f7750>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1044cd1c0>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ StatementError("(builtins.AttributeError) 'str' object has no attribute 'hex'")
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x104506a20>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x104506d40>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>
          └ <app.core.middleware.RequestLoggerMiddleware object at 0x104525050>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x10271ede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x105805900>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [StatementError("(builtins.AttributeError) 'str' object has no attribute 'h...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1046083c0>
    └ <contextlib._GeneratorContextManager object at 0x1053f5450>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x105910180>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1053f5750>
                     │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>>
                     └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    return await call_next(request)
                 │         └ <starlette.middleware.base._CachedRequest object at 0x1053f5750>
                 └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x105910180>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ StatementError("(builtins.AttributeError) 'str' object has no attribute 'hex'")
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x105911e40>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105911f80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x104524990>
          └ <app.core.middleware.RateLimitMiddleware object at 0x1045248d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x105911e40>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105911f80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x104524a90>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x104524990>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x105911e40>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105911f80>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │                            │    │    └ <starlette.requests.Request object at 0x1053f7510>
          │                            │    └ <fastapi.routing.APIRouter object at 0x10430be10>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x104524a90>
          └ <function wrap_app_handling_exceptions at 0x10278eca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105912700>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105911f80>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          └ <fastapi.routing.APIRouter object at 0x10430be10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105912700>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105911f80>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x10430be10>>
          └ <fastapi.routing.APIRouter object at 0x10430be10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105912700>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105911f80>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │     └ <function Route.handle at 0x1027bc4a0>
          └ APIRoute(path='/api/admin/statistics', name='get_statistics', methods=['GET'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105912700>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105911f80>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │    └ <function request_response.<locals>.app at 0x104362b60>
          └ APIRoute(path='/api/admin/statistics', name='get_statistics', methods=['GET'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x105912700>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105911f80>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          │                            │    └ <starlette.requests.Request object at 0x1053f7210>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1059127a0>
          └ <function wrap_app_handling_exceptions at 0x10278eca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1059136a0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x105911f80>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/statistics', 'raw_path': b'/api/admin/statistics...
          └ <function request_response.<locals>.app.<locals>.app at 0x1059127a0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x1053f7210>
                     └ <function get_request_handler.<locals>.app at 0x104362ac0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x10091b740>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x1053f6210>, 'admin_user': <app.models.user.User object at 0x104e75110>}
                 │                 │         └ <function get_statistics at 0x10420e020>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x104396610>
                 └ <function run_in_threadpool at 0x10258f2e0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function get_statistics at 0x10420e020>, db=<sqlalchemy.orm.session.Session object at 0x1053f6210>, admin_...
                 │     │         └ <function run_sync at 0x101ec6a20>
                 │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
                 └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x101ec5d00>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=StatementError("(builtins.AttributeError) 'str' object has no attribute 'hex'")>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/statistics.py", line 26, in get_statistics
    log_admin_action(db, str(admin_user.id), "view_statistics", None)
    │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x103f6fec0>
    │                │       └ <app.models.user.User object at 0x104e75110>
    │                └ <sqlalchemy.orm.session.Session object at 0x1053f6210>
    └ <function log_admin_action at 0x10420d4e0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 16, in log_admin_action
    db.commit()
    │  └ <function Session.commit at 0x103bf74c0>
    └ <sqlalchemy.orm.session.Session object at 0x1053f6210>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2017, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x103bf65c0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x105914be0>
  File "<string>", line 2, in commit
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x105914be0>
                └ <function SessionTransaction.commit at 0x103bf63e0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1302, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x103bf62a0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x105914be0>
  File "<string>", line 2, in _prepare_impl
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x105914be0>
                └ <function SessionTransaction._prepare_impl at 0x103bf6200>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1277, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x103c0e3e0>
    │    └ <sqlalchemy.orm.session.Session object at 0x1053f6210>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x105914be0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4341, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x103c0e5c0>
    └ <sqlalchemy.orm.session.Session object at 0x1053f6210>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4476, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/ut...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x105807780>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ StatementError("(builtins.AttributeError) 'str' object has no attribute 'hex'")
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4437, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x103bdee80>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x104de1210>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x104de1210>
    │   └ <function SaveUpdateAll.execute at 0x103bdf9c0>
    └ SaveUpdateAll(Mapper[AdminLog(admin_logs)])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x103b3a160>
    │    │         └ <module 'sqlalchemy.orm.persistence' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sq...
    │    └ <module 'sqlalchemy.util.preloaded' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sql...
    └ <module 'sqlalchemy.util' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/ut...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x103bc5a80>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x1038754e0>
             └ <sqlalchemy.engine.base.Connection object at 0x104e74710>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x105807d90>>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x103875800>
           └ <sqlalchemy.engine.base.Connection object at 0x104e74710>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x1038759e0>
          └ <sqlalchemy.engine.base.Connection object at 0x104e74710>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1821, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x103875d00>
    └ <sqlalchemy.engine.base.Connection object at 0x104e74710>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2353, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ AttributeError("'str' object has no attribute 'hex'")
          │                    │              └ (<class 'AttributeError'>, AttributeError("'str' object has no attribute 'hex'"), <traceback object at 0x105807940>)
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ StatementError("(builtins.AttributeError) 'str' object has no attribute 'hex'")
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 1815, in _execute_context
    context = constructor(
              └ <bound method DefaultExecutionContext._init_compiled of <class 'sqlalchemy.dialects.sqlite.base.SQLiteExecutionContext'>>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 1457, in _init_compiled
    l_param: List[Any] = [
             │    └ typing.Any
             └ typing.List
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 1459, in <listcomp>
    flattened_processors[key](compiled_params[key])
    │                    │    │               └ 'admin_id'
    │                    │    └ {'id': UUID('5fe7ff29-7099-4164-8147-062f4b103e9a'), 'admin_id': '1c65f61f-e140-4240-b2f4-3196e2057e25', 'action': 'view_stat...
    │                    └ 'admin_id'
    └ {'id': <function Uuid.bind_processor.<locals>.process at 0x1058d6c00>, 'admin_id': <function Uuid.bind_processor.<locals>.pro...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 3608, in process
    value = value.hex
            └ '1c65f61f-e140-4240-b2f4-3196e2057e25'

sqlalchemy.exc.StatementError: (builtins.AttributeError) 'str' object has no attribute 'hex'
[SQL: INSERT INTO admin_logs (id, admin_id, action, target_id, details) VALUES (?, ?, ?, ?, ?) RETURNING created_at]
[parameters: [{'details': '{}', 'admin_id': '1c65f61f-e140-4240-b2f4-3196e2057e25', 'action': 'view_statistics', 'target_id': None}]]
[2025-10-17 01:26:07] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (22.83 ms)
[2025-10-17 01:26:07] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.87 ms)
[2025-10-17 01:26:07] INFO — [REQUEST] GET /api/admin/users from unknown -> 403 (1.89 ms)
[2025-10-17 01:26:07] INFO — admin_action method=GET path=/api/admin/users status=403 admin_id=20e5696c-ea3c-47aa-b300-884b27eda128
[2025-10-17 01:26:07] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (3.46 ms)
[2025-10-17 01:26:07] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.56 ms)
[2025-10-17 01:26:07] INFO — [REQUEST] GET /api/admin/users from unknown -> 200 (2.60 ms)
[2025-10-17 01:26:07] INFO — admin_action method=GET path=/api/admin/users status=200 admin_id=e0d3b9f0-271e-421c-a1c4-18ca99d4f22d
[2025-10-17 01:26:07] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.30 ms)
[2025-10-17 01:26:07] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.66 ms)
[2025-10-17 01:26:07] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.14 ms)
[2025-10-17 01:26:07] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.84 ms)
[2025-10-17 01:26:07] ERROR — Unhandled exception at %s
  + Exception Group Traceback (most recent call last):
  |
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                │     │                      └ <anyio._backends._asyncio.TaskGroup object at 0x107f0b050>
  |                │     └ <function create_task_group at 0x103f64d60>
  |                └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x107e311c0>
    |           │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x107df8360>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
    |           │    └ <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x107f3fb10>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x1057dede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x107f7a0c0>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x107e3b5a0>
    |     └ <contextlib._GeneratorContextManager object at 0x107f0b110>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x107e31f80>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x107f0af10>
    |                      │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>>
    |                      └ <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x107f0af10>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x107e31f80>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type AdminLevel is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x107e30d60>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e32520>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
    |           │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>
    |           └ <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x1057dede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x107f7a400>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x107f37300>
    |     └ <contextlib._GeneratorContextManager object at 0x107f09610>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x107e31620>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x107f09550>
    |                      │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>>
    |                      └ <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x107f09550>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x107e31620>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type AdminLevel is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x107e32d40>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e323e0>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
    |           │    └ <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>
    |           └ <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x1057dede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x107f78a40>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x107f374c0>
    |     └ <contextlib._GeneratorContextManager object at 0x107f09a10>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x107e31ee0>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x107f0a310>
    |                      │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>>
    |                      └ <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    |     return await call_next(request)
    |                  │         └ <starlette.middleware.base._CachedRequest object at 0x107f0a310>
    |                  └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x107e31ee0>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type AdminLevel is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x107e316c0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x107f3f510>
    |           └ <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x107e316c0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x107f3f550>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x107f3f510>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x107e316c0>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
    |           │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
    |           │                            │    │    └ <starlette.requests.Request object at 0x107f0bb50>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x107c2fcd0>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x107f3f550>
    |           └ <function wrap_app_handling_exceptions at 0x10625eca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107e328e0>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
    |           │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
    |           └ <fastapi.routing.APIRouter object at 0x107c2fcd0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107e328e0>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
    |           │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x107c2fcd0>>
    |           └ <fastapi.routing.APIRouter object at 0x107c2fcd0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107e328e0>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
    |           │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
    |           │     └ <function Route.handle at 0x10628c4a0>
    |           └ APIRoute(path='/api/admin/users/{user_id}/role', name='update_user_role', methods=['PATCH'])
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107e328e0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
    |           │    └ <function request_response.<locals>.app at 0x107c8e160>
    |           └ APIRoute(path='/api/admin/users/{user_id}/role', name='update_user_role', methods=['PATCH'])
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107e328e0>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
    |           │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
    |           │                            │    └ <starlette.requests.Request object at 0x107f0bb90>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x107e32f20>
    |           └ <function wrap_app_handling_exceptions at 0x10625eca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107e33060>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
    |           │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x107e32f20>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    |     response = await func(request)
    |                      │    └ <starlette.requests.Request object at 0x107f0bb90>
    |                      └ <function get_request_handler.<locals>.app at 0x107c8e020>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |                          └ <function run_endpoint_function at 0x102583740>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |                  │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x107f78750>, 'admin_user': <app.models.user.User object at 0x107fc1ad0>, 'u...
    |                  │                 │         └ <function update_user_role at 0x1079deac0>
    |                  │                 └ <fastapi.dependencies.models.Dependant object at 0x107caf310>
    |                  └ <function run_in_threadpool at 0x10564f2e0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |                  │     │         │        │      └ ()
    |                  │     │         │        └ functools.partial(<function update_user_role at 0x1079deac0>, db=<sqlalchemy.orm.session.Session object at 0x107f78750>, admi...
    |                  │     │         └ <function run_sync at 0x103e0aa20>
    |                  │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
    |                  └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |                  └ <function get_async_backend at 0x103e09d00>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    |     return await future
    |                  └ <Future finished exception=TypeError('Object of type AdminLevel is not JSON serializable')>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    |     result = context.run(func, *args)
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/users.py", line 51, in update_user_role
    |     log_admin_action(db, str(admin_user.id), "update_user_role", str(user.id), metadata=payload.model_dump())
    |     │                │       │          │                            │    │             │       └ <function BaseModel.model_dump at 0x1055afce0>
    |     │                │       │          │                            │    │             └ AdminUserRoleUpdate(role=None, admin_level=<AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, permissions={'can_review': True})
    |     │                │       │          │                            │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x10773fec0>
    |     │                │       │          │                            └ <app.models.user.User object at 0x107f081d0>
    |     │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x10773fec0>
    |     │                │       └ <app.models.user.User object at 0x107fc1ad0>
    |     │                └ <sqlalchemy.orm.session.Session object at 0x107f78750>
    |     └ <function log_admin_action at 0x1079dd300>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 14, in log_admin_action
    |     entry = AdminLog(admin_id=admin_id, action=action, target_id=target_id, details=json.dumps(metadata or {}))
    |             │                 │                │                 │                  │    │     └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
    |             │                 │                │                 │                  │    └ <function dumps at 0x1033ae480>
    |             │                 │                │                 │                  └ <module 'json' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py'>
    |             │                 │                │                 └ 'f1d97ebc-b9c8-40ba-9b11-486903d0655e'
    |             │                 │                └ 'update_user_role'
    |             │                 └ '9127f6f8-d71d-4252-8250-b0658b5032c7'
    |             └ <class 'app.models.admin_log.AdminLog'>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    |     return _default_encoder.encode(obj)
    |            │                │      └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
    |            │                └ <function JSONEncoder.encode at 0x1033af420>
    |            └ <json.encoder.JSONEncoder object at 0x1033b4750>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    |     chunks = self.iterencode(o, _one_shot=True)
    |              │    │          └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
    |              │    └ <function JSONEncoder.iterencode at 0x1033af4c0>
    |              └ <json.encoder.JSONEncoder object at 0x1033b4750>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    |     return _iterencode(o, 0)
    |            │           └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
    |            └ <_json.Encoder object at 0x107ee73a0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    |     raise TypeError(f'Object of type {o.__class__.__name__} '
    |
    | TypeError: Object of type AdminLevel is not JSON serializable
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x102ba1800>
    └ <Thread(asyncio-portal-107e43e90, started daemon 6185136128)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x102ba14e0>
    └ <Thread(asyncio-portal-107e43e90, started daemon 6185136128)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-107e43e90, started daemon 6185136128)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-107e43e90, started daemon 6185136128)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x107e9b4c0>
    └ <Thread(asyncio-portal-107e43e90, started daemon 6185136128)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 519, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x103dd3100>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_core/_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x107c42a20>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x107df6520>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2325, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x107e32660>
           │      └ <function Runner.run at 0x1050b4900>
           └ <asyncio.runners.Runner object at 0x107fc28d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1050b2480>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x107fc28d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 641, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1050b23e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 608, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1050b4220>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1936, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10503c900>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 252, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x107dc3c40>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x107df8720>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x107df8360>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x107df8720>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x107df8360>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x107f3fb10>
          └ <fastapi.applications.FastAPI object at 0x107c2f790>
> File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x107e311c0>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x107df8360>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          │    └ <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x107f3fb10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1057dede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x107f7a0c0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x107e3b5a0>
    └ <contextlib._GeneratorContextManager object at 0x107f0b110>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x107e31f80>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x107f0af10>
                     │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>>
                     └ <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x107f0af10>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x107e31f80>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type AdminLevel is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x107e30d60>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e32520>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>
          └ <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1057dede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x107f7a400>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x107f37300>
    └ <contextlib._GeneratorContextManager object at 0x107f09610>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x107e31620>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x107f09550>
                     │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>>
                     └ <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x107f09550>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x107e31620>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type AdminLevel is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x107e32d40>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e323e0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          │    └ <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>
          └ <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1057dede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x107f78a40>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type AdminLevel is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x107f374c0>
    └ <contextlib._GeneratorContextManager object at 0x107f09a10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x107e31ee0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x107f0a310>
                     │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>>
                     └ <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    return await call_next(request)
                 │         └ <starlette.middleware.base._CachedRequest object at 0x107f0a310>
                 └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x107e31ee0>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type AdminLevel is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x107e316c0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x107f3f510>
          └ <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x107e316c0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x107f3f550>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x107f3f510>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x107e316c0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          │                            │    │    └ <starlette.requests.Request object at 0x107f0bb50>
          │                            │    └ <fastapi.routing.APIRouter object at 0x107c2fcd0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x107f3f550>
          └ <function wrap_app_handling_exceptions at 0x10625eca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107e328e0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          └ <fastapi.routing.APIRouter object at 0x107c2fcd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107e328e0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x107c2fcd0>>
          └ <fastapi.routing.APIRouter object at 0x107c2fcd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107e328e0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          │     └ <function Route.handle at 0x10628c4a0>
          └ APIRoute(path='/api/admin/users/{user_id}/role', name='update_user_role', methods=['PATCH'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107e328e0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          │    └ <function request_response.<locals>.app at 0x107c8e160>
          └ APIRoute(path='/api/admin/users/{user_id}/role', name='update_user_role', methods=['PATCH'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107e328e0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          │                            │    └ <starlette.requests.Request object at 0x107f0bb90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x107e32f20>
          └ <function wrap_app_handling_exceptions at 0x10625eca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x107e33060>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x107e31080>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/users/f1d97ebc-b9c8-40ba-9b11-486903d0655e/rol...
          └ <function request_response.<locals>.app.<locals>.app at 0x107e32f20>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x107f0bb90>
                     └ <function get_request_handler.<locals>.app at 0x107c8e020>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x102583740>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x107f78750>, 'admin_user': <app.models.user.User object at 0x107fc1ad0>, 'u...
                 │                 │         └ <function update_user_role at 0x1079deac0>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x107caf310>
                 └ <function run_in_threadpool at 0x10564f2e0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function update_user_role at 0x1079deac0>, db=<sqlalchemy.orm.session.Session object at 0x107f78750>, admi...
                 │     │         └ <function run_sync at 0x103e0aa20>
                 │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
                 └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x103e09d00>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=TypeError('Object of type AdminLevel is not JSON serializable')>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/users.py", line 51, in update_user_role
    log_admin_action(db, str(admin_user.id), "update_user_role", str(user.id), metadata=payload.model_dump())
    │                │       │          │                            │    │             │       └ <function BaseModel.model_dump at 0x1055afce0>
    │                │       │          │                            │    │             └ AdminUserRoleUpdate(role=None, admin_level=<AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, permissions={'can_review': True})
    │                │       │          │                            │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x10773fec0>
    │                │       │          │                            └ <app.models.user.User object at 0x107f081d0>
    │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x10773fec0>
    │                │       └ <app.models.user.User object at 0x107fc1ad0>
    │                └ <sqlalchemy.orm.session.Session object at 0x107f78750>
    └ <function log_admin_action at 0x1079dd300>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 14, in log_admin_action
    entry = AdminLog(admin_id=admin_id, action=action, target_id=target_id, details=json.dumps(metadata or {}))
            │                 │                │                 │                  │    │     └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
            │                 │                │                 │                  │    └ <function dumps at 0x1033ae480>
            │                 │                │                 │                  └ <module 'json' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py'>
            │                 │                │                 └ 'f1d97ebc-b9c8-40ba-9b11-486903d0655e'
            │                 │                └ 'update_user_role'
            │                 └ '9127f6f8-d71d-4252-8250-b0658b5032c7'
            └ <class 'app.models.admin_log.AdminLog'>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
           │                └ <function JSONEncoder.encode at 0x1033af420>
           └ <json.encoder.JSONEncoder object at 0x1033b4750>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
             │    └ <function JSONEncoder.iterencode at 0x1033af4c0>
             └ <json.encoder.JSONEncoder object at 0x1033b4750>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'role': None, 'admin_level': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'permissions': {'can_review': True}}
           └ <_json.Encoder object at 0x107ee73a0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type AdminLevel is not JSON serializable
[2025-10-17 01:26:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.54 ms)
[2025-10-17 01:26:08] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (2.00 ms)
[2025-10-17 01:26:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (1.97 ms)
[2025-10-17 01:26:08] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.37 ms)
[2025-10-17 01:26:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.07 ms)
[2025-10-17 01:26:08] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.63 ms)
[2025-10-17 01:26:08] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (3.05 ms)
[2025-10-17 01:26:08] ERROR — Unhandled exception at %s
  + Exception Group Traceback (most recent call last):
  |
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 87, in collapse_excgroups
  |     yield
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                │     │                      └ <anyio._backends._asyncio.TaskGroup object at 0x110d6c710>
  |                │     └ <function create_task_group at 0x103f64d60>
  |                └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 781, in __aexit__
  |     raise BaseExceptionGroup(
  |
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x111470400>
    |           │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x107e336a0>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
    |           │    └ <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x107f3fb10>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x1057dede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x110b23300>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x11146c2e0>
    |     └ <contextlib._GeneratorContextManager object at 0x110d6dc90>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x111470e00>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x110d6f390>
    |                      │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>>
    |                      └ <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x110d6f390>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x111470e00>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type CampaignStatus is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111470d60>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111471760>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
    |           │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>
    |           └ <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x1057dede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x110b238c0>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x11146f760>
    |     └ <contextlib._GeneratorContextManager object at 0x110d6c810>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x111471ee0>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x110d6eb90>
    |                      │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>>
    |                      └ <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x110d6eb90>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x111471ee0>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type CampaignStatus is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1114719e0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470860>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
    |           │    └ <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>
    |           └ <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          └ <function collapse_excgroups at 0x1057dede0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x110b20300>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    |     │    │   │     └ <class 'ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x11146c660>
    |     └ <contextlib._GeneratorContextManager object at 0x110d6eb50>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1102174c0>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x110d6f650>
    |                      │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>>
    |                      └ <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    |     return await call_next(request)
    |                  │         └ <starlette.middleware.base._CachedRequest object at 0x110d6f650>
    |                  └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1102174c0>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type CampaignStatus is not JSON serializable')
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111470cc0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x107f3f510>
    |           └ <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111470cc0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x107f3f550>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x107f3f510>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111470cc0>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
    |           │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
    |           │                            │    │    └ <starlette.requests.Request object at 0x110cbba10>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x107c2fcd0>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x107f3f550>
    |           └ <function wrap_app_handling_exceptions at 0x10625eca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111470040>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
    |           │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
    |           └ <fastapi.routing.APIRouter object at 0x107c2fcd0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111470040>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
    |           │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x107c2fcd0>>
    |           └ <fastapi.routing.APIRouter object at 0x107c2fcd0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111470040>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
    |           │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
    |           │     └ <function Route.handle at 0x10628c4a0>
    |           └ APIRoute(path='/api/admin/campaigns/{campaign_id}/status', name='update_campaign_status', methods=['PATCH'])
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111470040>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
    |           │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
    |           │    └ <function request_response.<locals>.app at 0x107c8e5c0>
    |           └ APIRoute(path='/api/admin/campaigns/{campaign_id}/status', name='update_campaign_status', methods=['PATCH'])
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111470040>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
    |           │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
    |           │                            │    └ <starlette.requests.Request object at 0x110cb8710>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x111470540>
    |           └ <function wrap_app_handling_exceptions at 0x10625eca0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1114716c0>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
    |           │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x111470540>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    |     response = await func(request)
    |                      │    └ <starlette.requests.Request object at 0x110cb8710>
    |                      └ <function get_request_handler.<locals>.app at 0x107c8e480>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    |     raw_response = await run_endpoint_function(
    |                          └ <function run_endpoint_function at 0x102583740>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    |     return await run_in_threadpool(dependant.call, **values)
    |                  │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x110b3a010>, 'admin_user': <app.models.user.User object at 0x1110633d0>, 'c...
    |                  │                 │         └ <function update_campaign_status at 0x1079dd6c0>
    |                  │                 └ <fastapi.dependencies.models.Dependant object at 0x107cbb6d0>
    |                  └ <function run_in_threadpool at 0x10564f2e0>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    |     return await anyio.to_thread.run_sync(func, *args)
    |                  │     │         │        │      └ ()
    |                  │     │         │        └ functools.partial(<function update_campaign_status at 0x1079dd6c0>, db=<sqlalchemy.orm.session.Session object at 0x110b3a010>...
    |                  │     │         └ <function run_sync at 0x103e0aa20>
    |                  │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
    |                  └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    |     return await get_async_backend().run_sync_in_worker_thread(
    |                  └ <function get_async_backend at 0x103e09d00>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    |     return await future
    |                  └ <Future finished exception=TypeError('Object of type CampaignStatus is not JSON serializable')>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    |     result = context.run(func, *args)
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/campaigns.py", line 45, in update_campaign_status
    |     log_admin_action(db, str(admin_user.id), "update_campaign_status", str(campaign_id), metadata=payload.model_dump())
    |     │                │       │          │                                  │                      │       └ <function BaseModel.model_dump at 0x1055afce0>
    |     │                │       │          │                                  │                      └ AdminCampaignStatusUpdate(status=<CampaignStatus.PAUSED: 'paused'>)
    |     │                │       │          │                                  └ UUID('4cdfbb75-98c6-4af3-a2ae-c091131711d1')
    |     │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x10773fec0>
    |     │                │       └ <app.models.user.User object at 0x1110633d0>
    |     │                └ <sqlalchemy.orm.session.Session object at 0x110b3a010>
    |     └ <function log_admin_action at 0x1079dd300>
    |
    |   File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 14, in log_admin_action
    |     entry = AdminLog(admin_id=admin_id, action=action, target_id=target_id, details=json.dumps(metadata or {}))
    |             │                 │                │                 │                  │    │     └ {'status': <CampaignStatus.PAUSED: 'paused'>}
    |             │                 │                │                 │                  │    └ <function dumps at 0x1033ae480>
    |             │                 │                │                 │                  └ <module 'json' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py'>
    |             │                 │                │                 └ '4cdfbb75-98c6-4af3-a2ae-c091131711d1'
    |             │                 │                └ 'update_campaign_status'
    |             │                 └ 'f0800df2-baca-4d00-a6d4-f9eb9c3ea0b2'
    |             └ <class 'app.models.admin_log.AdminLog'>
    |
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    |     return _default_encoder.encode(obj)
    |            │                │      └ {'status': <CampaignStatus.PAUSED: 'paused'>}
    |            │                └ <function JSONEncoder.encode at 0x1033af420>
    |            └ <json.encoder.JSONEncoder object at 0x1033b4750>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    |     chunks = self.iterencode(o, _one_shot=True)
    |              │    │          └ {'status': <CampaignStatus.PAUSED: 'paused'>}
    |              │    └ <function JSONEncoder.iterencode at 0x1033af4c0>
    |              └ <json.encoder.JSONEncoder object at 0x1033b4750>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    |     return _iterencode(o, 0)
    |            │           └ {'status': <CampaignStatus.PAUSED: 'paused'>}
    |            └ <_json.Encoder object at 0x110384940>
    |   File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    |     raise TypeError(f'Object of type {o.__class__.__name__} '
    |
    | TypeError: Object of type CampaignStatus is not JSON serializable
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x102ba1800>
    └ <Thread(asyncio-portal-111063bd0, started daemon 6185136128)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x102ba14e0>
    └ <Thread(asyncio-portal-111063bd0, started daemon 6185136128)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-111063bd0, started daemon 6185136128)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-111063bd0, started daemon 6185136128)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x110217600>
    └ <Thread(asyncio-portal-111063bd0, started daemon 6185136128)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 519, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x103dd3100>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_core/_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x1102176a0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x107df6520>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2325, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x110217740>
           │      └ <function Runner.run at 0x1050b4900>
           └ <asyncio.runners.Runner object at 0x111060690>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x1050b2480>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x111060690>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 641, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x1050b23e0>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 608, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x1050b4220>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1936, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10503c900>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 252, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x107e7d140>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x110217ec0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x107e336a0>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x110217ec0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x107e336a0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x107f3fb10>
          └ <fastapi.applications.FastAPI object at 0x107c2f790>
> File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x111470400>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x107e336a0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          │    └ <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x107f3fb10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1057dede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x110b23300>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x11146c2e0>
    └ <contextlib._GeneratorContextManager object at 0x110d6dc90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x111470e00>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x110d6f390>
                     │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>>
                     └ <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x110d6f390>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x111470e00>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type CampaignStatus is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111470d60>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111471760>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>
          └ <app.core.middleware.AdminActionMiddleware object at 0x107f3f9d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1057dede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x110b238c0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x11146f760>
    └ <contextlib._GeneratorContextManager object at 0x110d6c810>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x111471ee0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x110d6eb90>
                     │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>>
                     └ <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x110d6eb90>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x111471ee0>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type CampaignStatus is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1114719e0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470860>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          │    └ <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>
          └ <app.core.middleware.RequestLoggerMiddleware object at 0x107a17cd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x1057dede0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x110b20300>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type CampaignStatus is not JSON serializable')])
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x11146c660>
    └ <contextlib._GeneratorContextManager object at 0x110d6eb50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1102174c0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x110d6f650>
                     │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>>
                     └ <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    return await call_next(request)
                 │         └ <starlette.middleware.base._CachedRequest object at 0x110d6f650>
                 └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1102174c0>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ TypeError('Object of type CampaignStatus is not JSON serializable')
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111470cc0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x107f3f510>
          └ <app.core.middleware.RateLimitMiddleware object at 0x107f3f610>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111470cc0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x107f3f550>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x107f3f510>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x111470cc0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          │                            │    │    └ <starlette.requests.Request object at 0x110cbba10>
          │                            │    └ <fastapi.routing.APIRouter object at 0x107c2fcd0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x107f3f550>
          └ <function wrap_app_handling_exceptions at 0x10625eca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111470040>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          └ <fastapi.routing.APIRouter object at 0x107c2fcd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111470040>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x107c2fcd0>>
          └ <fastapi.routing.APIRouter object at 0x107c2fcd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111470040>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          │     └ <function Route.handle at 0x10628c4a0>
          └ APIRoute(path='/api/admin/campaigns/{campaign_id}/status', name='update_campaign_status', methods=['PATCH'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111470040>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          │    └ <function request_response.<locals>.app at 0x107c8e5c0>
          └ APIRoute(path='/api/admin/campaigns/{campaign_id}/status', name='update_campaign_status', methods=['PATCH'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x111470040>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          │                            │    └ <starlette.requests.Request object at 0x110cb8710>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x111470540>
          └ <function wrap_app_handling_exceptions at 0x10625eca0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1114716c0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x111470f40>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'PATCH', 'path': '/api/admin/campaigns/4cdfbb75-98c6-4af3-a2ae-c091131711d1...
          └ <function request_response.<locals>.app.<locals>.app at 0x111470540>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x110cb8710>
                     └ <function get_request_handler.<locals>.app at 0x107c8e480>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x102583740>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x110b3a010>, 'admin_user': <app.models.user.User object at 0x1110633d0>, 'c...
                 │                 │         └ <function update_campaign_status at 0x1079dd6c0>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x107cbb6d0>
                 └ <function run_in_threadpool at 0x10564f2e0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function update_campaign_status at 0x1079dd6c0>, db=<sqlalchemy.orm.session.Session object at 0x110b3a010>...
                 │     │         └ <function run_sync at 0x103e0aa20>
                 │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
                 └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x103e09d00>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=TypeError('Object of type CampaignStatus is not JSON serializable')>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/campaigns.py", line 45, in update_campaign_status
    log_admin_action(db, str(admin_user.id), "update_campaign_status", str(campaign_id), metadata=payload.model_dump())
    │                │       │          │                                  │                      │       └ <function BaseModel.model_dump at 0x1055afce0>
    │                │       │          │                                  │                      └ AdminCampaignStatusUpdate(status=<CampaignStatus.PAUSED: 'paused'>)
    │                │       │          │                                  └ UUID('4cdfbb75-98c6-4af3-a2ae-c091131711d1')
    │                │       │          └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x10773fec0>
    │                │       └ <app.models.user.User object at 0x1110633d0>
    │                └ <sqlalchemy.orm.session.Session object at 0x110b3a010>
    └ <function log_admin_action at 0x1079dd300>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/services/admin_logs.py", line 14, in log_admin_action
    entry = AdminLog(admin_id=admin_id, action=action, target_id=target_id, details=json.dumps(metadata or {}))
            │                 │                │                 │                  │    │     └ {'status': <CampaignStatus.PAUSED: 'paused'>}
            │                 │                │                 │                  │    └ <function dumps at 0x1033ae480>
            │                 │                │                 │                  └ <module 'json' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py'>
            │                 │                │                 └ '4cdfbb75-98c6-4af3-a2ae-c091131711d1'
            │                 │                └ 'update_campaign_status'
            │                 └ 'f0800df2-baca-4d00-a6d4-f9eb9c3ea0b2'
            └ <class 'app.models.admin_log.AdminLog'>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           │                │      └ {'status': <CampaignStatus.PAUSED: 'paused'>}
           │                └ <function JSONEncoder.encode at 0x1033af420>
           └ <json.encoder.JSONEncoder object at 0x1033b4750>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'status': <CampaignStatus.PAUSED: 'paused'>}
             │    └ <function JSONEncoder.iterencode at 0x1033af4c0>
             └ <json.encoder.JSONEncoder object at 0x1033b4750>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           │           └ {'status': <CampaignStatus.PAUSED: 'paused'>}
           └ <_json.Encoder object at 0x110384940>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type CampaignStatus is not JSON serializable
[2025-10-17 01:26:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.75 ms)
[2025-10-17 01:26:08] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.54 ms)
[2025-10-17 01:26:08] INFO — [REQUEST] GET /api/admin/statistics from unknown -> 200 (6.31 ms)
[2025-10-17 01:26:08] INFO — admin_action method=GET path=/api/admin/statistics status=200 admin_id=3b8563ef-1f90-4449-a04b-6ef90a4b8461
[2025-10-17 01:26:08] INFO — [REQUEST] GET /api/admin/statistics/export from unknown -> 200 (2.80 ms)
[2025-10-17 01:26:08] INFO — admin_action method=GET path=/api/admin/statistics/export status=200 admin_id=3b8563ef-1f90-4449-a04b-6ef90a4b8461
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (21.11 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.76 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] GET /api/admin/users from unknown -> 403 (1.91 ms)
[2025-10-17 01:26:45] INFO — admin_action method=GET path=/api/admin/users status=403 admin_id=c69f534b-7df0-4b78-ae53-99f1a5ac7b37
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.87 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.58 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] GET /api/admin/users from unknown -> 200 (2.24 ms)
[2025-10-17 01:26:45] INFO — admin_action method=GET path=/api/admin/users status=200 admin_id=8ec29933-dfc6-44c8-9912-8447c780ad9d
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (1.93 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.38 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.21 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.35 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] PATCH /api/admin/users/c9d8ab34-75d6-454a-8445-27a42ac7b274/role from unknown -> 200 (3.24 ms)
[2025-10-17 01:26:45] INFO — admin_action method=PATCH path=/api/admin/users/c9d8ab34-75d6-454a-8445-27a42ac7b274/role status=200 admin_id=cbb383fd-6c14-4a63-9d15-bbac87ac9d65
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.18 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.40 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (1.83 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.61 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.00 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (20.51 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (4.54 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] PATCH /api/admin/campaigns/4f6ba6c9-c972-4c4a-b565-0636718b0b6a/status from unknown -> 200 (2.88 ms)
[2025-10-17 01:26:45] INFO — admin_action method=PATCH path=/api/admin/campaigns/4f6ba6c9-c972-4c4a-b565-0636718b0b6a/status status=200 admin_id=4f1bcfea-c4e9-4ccb-b9b0-65f121c3dd38
[2025-10-17 01:26:45] INFO — [REQUEST] DELETE /api/admin/campaigns/4f6ba6c9-c972-4c4a-b565-0636718b0b6a from unknown -> 403 (1.28 ms)
[2025-10-17 01:26:45] INFO — admin_action method=DELETE path=/api/admin/campaigns/4f6ba6c9-c972-4c4a-b565-0636718b0b6a status=403 admin_id=4f1bcfea-c4e9-4ccb-b9b0-65f121c3dd38
[2025-10-17 01:26:45] INFO — [REQUEST] DELETE /api/admin/campaigns/4f6ba6c9-c972-4c4a-b565-0636718b0b6a from unknown -> 204 (4.44 ms)
[2025-10-17 01:26:45] INFO — admin_action method=DELETE path=/api/admin/campaigns/4f6ba6c9-c972-4c4a-b565-0636718b0b6a status=204 admin_id=ba86935a-4cf4-4397-ab76-5f3f901da3cd
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.42 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.60 ms)
[2025-10-17 01:26:45] INFO — [REQUEST] GET /api/admin/statistics from unknown -> 200 (5.29 ms)
[2025-10-17 01:26:45] INFO — admin_action method=GET path=/api/admin/statistics status=200 admin_id=7a648bd2-b76e-4aa9-922a-5971c7948783
[2025-10-17 01:26:45] INFO — [REQUEST] GET /api/admin/statistics/export from unknown -> 200 (2.94 ms)
[2025-10-17 01:26:45] INFO — admin_action method=GET path=/api/admin/statistics/export status=200 admin_id=7a648bd2-b76e-4aa9-922a-5971c7948783
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (20.48 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.92 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] GET /api/admin/users from unknown -> 403 (2.40 ms)
[2025-10-17 01:27:07] INFO — admin_action method=GET path=/api/admin/users status=403 admin_id=ba4fe875-fcef-41ff-b159-25c9f7d66959
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.63 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.73 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] GET /api/admin/users from unknown -> 200 (2.64 ms)
[2025-10-17 01:27:07] INFO — admin_action method=GET path=/api/admin/users status=200 admin_id=a0d4a22b-e227-4c4d-86b9-6f21d3d13cf0
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.29 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.60 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (5.99 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.70 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] PATCH /api/admin/users/69b22d05-487d-4b21-9a96-b0725f817b77/role from unknown -> 200 (3.52 ms)
[2025-10-17 01:27:07] INFO — admin_action method=PATCH path=/api/admin/users/69b22d05-487d-4b21-9a96-b0725f817b77/role status=200 admin_id=df8062f0-b9f7-4367-b42e-452fd259e2c1
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.31 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.53 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.11 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.73 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (25.84 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.66 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (3.30 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] PATCH /api/admin/campaigns/f00b4bd3-da9f-40d8-aa45-b686526c9739/status from unknown -> 200 (3.55 ms)
[2025-10-17 01:27:07] INFO — admin_action method=PATCH path=/api/admin/campaigns/f00b4bd3-da9f-40d8-aa45-b686526c9739/status status=200 admin_id=82f9a4b2-8e77-4386-b7c7-f152061f7828
[2025-10-17 01:27:07] INFO — [REQUEST] DELETE /api/admin/campaigns/f00b4bd3-da9f-40d8-aa45-b686526c9739 from unknown -> 403 (1.56 ms)
[2025-10-17 01:27:07] INFO — admin_action method=DELETE path=/api/admin/campaigns/f00b4bd3-da9f-40d8-aa45-b686526c9739 status=403 admin_id=82f9a4b2-8e77-4386-b7c7-f152061f7828
[2025-10-17 01:27:07] INFO — [REQUEST] DELETE /api/admin/campaigns/f00b4bd3-da9f-40d8-aa45-b686526c9739 from unknown -> 204 (4.60 ms)
[2025-10-17 01:27:07] INFO — admin_action method=DELETE path=/api/admin/campaigns/f00b4bd3-da9f-40d8-aa45-b686526c9739 status=204 admin_id=c6d75b0f-8061-4d65-9f7d-2f83f2360a49
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.31 ms)
[2025-10-17 01:27:07] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.56 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /api/admin/statistics from unknown -> 200 (8.48 ms)
[2025-10-17 01:27:08] INFO — admin_action method=GET path=/api/admin/statistics status=200 admin_id=87ac2a36-07b1-4973-b2a7-06b8ce2a0e2a
[2025-10-17 01:27:08] INFO — [REQUEST] GET /api/admin/statistics/export from unknown -> 200 (4.10 ms)
[2025-10-17 01:27:08] INFO — admin_action method=GET path=/api/admin/statistics/export status=200 admin_id=87ac2a36-07b1-4973-b2a7-06b8ce2a0e2a
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.39 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.54 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.19 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.55 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/refresh from unknown -> 200 (1.66 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/logout from unknown -> 204 (0.69 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/refresh from unknown -> 401 (1.01 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.26 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.59 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (6.89 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /api/campaigns from unknown -> 200 (2.00 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.29 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.64 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.07 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (2.16 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/applications from unknown -> 201 (3.30 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/payments from unknown -> 201 (2.77 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.52 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/notifications/mark-read from unknown -> 200 (2.25 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.56 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.92 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.72 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (2.50 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] PATCH /api/orders/ef7b3fe4-b91e-4526-964b-cd369dc014b3 from unknown -> 200 (2.56 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /api/notifications from unknown -> 200 (1.99 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.48 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (1.89 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/payments from unknown -> 201 (1.90 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] POST /api/webhooks/payment from unknown -> 200 (2.97 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /api/notifications from unknown -> 200 (1.53 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.63 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.63 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.64 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.97 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.53 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.62 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.65 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.55 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.67 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.50 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.65 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.55 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.84 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.64 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.50 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (1.01 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.62 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.49 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.60 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.53 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.62 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.64 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.49 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.77 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.61 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.65 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.72 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.66 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.62 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.55 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.63 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.50 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.64 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.64 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.63 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.73 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.63 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.65 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.72 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.58 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.74 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.98 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.61 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.64 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.68 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.66 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.53 ms)
[2025-10-17 01:27:08] WARNING — Rate limit exceeded for %s
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 429 (1.26 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.77 ms)
[2025-10-17 01:27:08] INFO — [REQUEST] GET /health from unknown -> 200 (0.55 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (21.81 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.92 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /api/admin/users from unknown -> 403 (2.46 ms)
[2025-10-17 01:30:31] INFO — admin_action method=GET path=/api/admin/users status=403 admin_id=523b64ae-0989-4fe6-bb0a-5048a294085a
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.91 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.69 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /api/admin/users from unknown -> 200 (2.34 ms)
[2025-10-17 01:30:31] INFO — admin_action method=GET path=/api/admin/users status=200 admin_id=aa8881aa-a882-4cbe-ba3d-33effe210406
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.63 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.70 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.41 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.66 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] PATCH /api/admin/users/cc96a438-744e-4afe-8580-990402b5b20e/role from unknown -> 200 (3.51 ms)
[2025-10-17 01:30:31] INFO — admin_action method=PATCH path=/api/admin/users/cc96a438-744e-4afe-8580-990402b5b20e/role status=200 admin_id=58b21cd8-3f20-47b9-9567-deb8c5723d38
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.36 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.61 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.03 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (2.35 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (22.19 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.64 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (4.39 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] PATCH /api/admin/campaigns/896ace78-3cb6-4cea-85b6-c0bf9a230413/status from unknown -> 200 (3.46 ms)
[2025-10-17 01:30:31] INFO — admin_action method=PATCH path=/api/admin/campaigns/896ace78-3cb6-4cea-85b6-c0bf9a230413/status status=200 admin_id=30e9bd48-10a4-43b3-bff9-bf44863bc0b6
[2025-10-17 01:30:31] INFO — [REQUEST] DELETE /api/admin/campaigns/896ace78-3cb6-4cea-85b6-c0bf9a230413 from unknown -> 403 (2.03 ms)
[2025-10-17 01:30:31] INFO — admin_action method=DELETE path=/api/admin/campaigns/896ace78-3cb6-4cea-85b6-c0bf9a230413 status=403 admin_id=30e9bd48-10a4-43b3-bff9-bf44863bc0b6
[2025-10-17 01:30:31] INFO — [REQUEST] DELETE /api/admin/campaigns/896ace78-3cb6-4cea-85b6-c0bf9a230413 from unknown -> 204 (5.19 ms)
[2025-10-17 01:30:31] INFO — admin_action method=DELETE path=/api/admin/campaigns/896ace78-3cb6-4cea-85b6-c0bf9a230413 status=204 admin_id=30d15628-cf1a-4b55-9251-59e136bb910b
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.35 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.55 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /api/admin/statistics from unknown -> 200 (8.13 ms)
[2025-10-17 01:30:31] INFO — admin_action method=GET path=/api/admin/statistics status=200 admin_id=1f93b1e0-6012-431d-bb0d-ee4a52c0cfec
[2025-10-17 01:30:31] INFO — [REQUEST] GET /api/admin/statistics/export from unknown -> 200 (3.24 ms)
[2025-10-17 01:30:31] INFO — admin_action method=GET path=/api/admin/statistics/export status=200 admin_id=1f93b1e0-6012-431d-bb0d-ee4a52c0cfec
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.38 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.59 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.23 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.65 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/refresh from unknown -> 200 (1.65 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/logout from unknown -> 204 (0.68 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/refresh from unknown -> 401 (1.01 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (6.37 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.69 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (2.39 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /api/campaigns from unknown -> 200 (8.40 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.41 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.97 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.13 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (2.53 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/applications from unknown -> 201 (3.12 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/payments from unknown -> 201 (2.68 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.56 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/notifications/mark-read from unknown -> 200 (2.87 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.36 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.36 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.67 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/campaigns from unknown -> 201 (3.09 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] PATCH /api/orders/3b46c74a-9208-49c1-8287-64c04240dfb6 from unknown -> 200 (2.05 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /api/notifications from unknown -> 200 (1.68 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.39 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (2.47 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/payments from unknown -> 201 (1.84 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] POST /api/webhooks/payment from unknown -> 200 (2.72 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /api/notifications from unknown -> 200 (1.53 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.65 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.53 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.64 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.53 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.97 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (1.01 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.56 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.63 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.62 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.67 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.62 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.69 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.53 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.63 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.56 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.68 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (4.71 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.75 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.62 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.66 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.53 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.61 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-17 01:30:31] INFO — [REQUEST] GET /health from unknown -> 200 (0.63 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.52 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.78 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.50 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.63 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.50 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.68 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.50 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.73 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.70 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.55 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.68 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.57 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.68 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.53 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.69 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.53 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.65 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.65 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.54 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.66 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.61 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.67 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.56 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.86 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.57 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.78 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.65 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.72 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.53 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.64 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.51 ms)
[2025-10-17 01:30:32] WARNING — Rate limit exceeded for %s
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 429 (1.57 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.72 ms)
[2025-10-17 01:30:32] INFO — [REQUEST] GET /health from unknown -> 200 (0.61 ms)
[2025-10-17 01:54:51] INFO — [REQUEST] POST /api/auth/register from unknown -> 201 (25.02 ms)
[2025-10-17 01:54:51] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (1.94 ms)
[2025-10-17 01:54:51] INFO — [REQUEST] POST /api/auth/refresh from unknown -> 200 (2.24 ms)
[2025-10-17 02:09:02] ERROR — Unhandled exception at %s
Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 1609, in _object_value_for_elem
    return self._object_lookup[elem]
           │    │              └ 'none'
           │    └ {'NONE': <AdminLevel.NONE: 'none'>, 'ADMIN_LEVEL_1': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'ADMIN_LEVEL_2': <AdminLeve...
           └ Enum('NONE', 'ADMIN_LEVEL_1', 'ADMIN_LEVEL_2', 'ADMIN_LEVEL_3', name='admin_level', _create_events=False)

KeyError: 'none'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x103247600>
    └ <Thread(asyncio-portal-106356c50, started daemon 6174076928)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x1032472e0>
    └ <Thread(asyncio-portal-106356c50, started daemon 6174076928)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-106356c50, started daemon 6174076928)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-106356c50, started daemon 6174076928)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x10667bec0>
    └ <Thread(asyncio-portal-106356c50, started daemon 6174076928)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 519, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x104d6d760>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_core/_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x10667bba0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x10670c720>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2325, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x1066d0040>
           │      └ <function Runner.run at 0x103a0f240>
           └ <asyncio.runners.Runner object at 0x106704990>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x103a0ce00>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x106704990>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 641, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x103a0cd60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 608, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x103a0eb60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1936, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10355b380>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 252, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x106696a40>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x102f14540>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1054ab240>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x102f14540>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1054ab240>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x106718b10>
          └ <fastapi.applications.FastAPI object at 0x1065b44d0>
> File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x10670e840>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1054ab240>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <app.core.middleware.AdminActionMiddleware object at 0x106718a90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x106718b10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x104fc2160>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x10691bd00>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [LookupError("'none' is not among the defined enum values. Enum name: admin...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1066f25e0>
    └ <contextlib._GeneratorContextManager object at 0x106718b50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x10670e8e0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1066c93d0>
                     │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x106718a90>>
                     └ <app.core.middleware.AdminActionMiddleware object at 0x106718a90>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x1066c93d0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x10670e8e0>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ LookupError("'none' is not among the defined enum values. Enum name: admin_level. Possible values: NONE, ADMIN_LEVEL.., ADMIN...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x10670eac0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x10670e980>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x106718a10>
          └ <app.core.middleware.AdminActionMiddleware object at 0x106718a90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x104fc2160>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x10691bb80>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [LookupError("'none' is not among the defined enum values. Enum name: admin...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1066f2a40>
    └ <contextlib._GeneratorContextManager object at 0x106719010>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x10670ed40>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x106718f10>
                     │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x106718a10>>
                     └ <app.core.middleware.RequestLoggerMiddleware object at 0x106718a10>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x106718f10>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x10670ed40>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ LookupError("'none' is not among the defined enum values. Enum name: admin_level. Possible values: NONE, ADMIN_LEVEL.., ADMIN...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x10670ef20>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x10670ede0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <app.core.middleware.RateLimitMiddleware object at 0x106553810>
          └ <app.core.middleware.RequestLoggerMiddleware object at 0x106718a10>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x104fc2160>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x10691ba00>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [LookupError("'none' is not among the defined enum values. Enum name: admin...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1066f3300>
    └ <contextlib._GeneratorContextManager object at 0x106719650>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x10670f1a0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x106719550>
                     │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x106553810>>
                     └ <app.core.middleware.RateLimitMiddleware object at 0x106553810>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    return await call_next(request)
                 │         └ <starlette.middleware.base._CachedRequest object at 0x106719550>
                 └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x10670f1a0>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ LookupError("'none' is not among the defined enum values. Enum name: admin_level. Possible values: NONE, ADMIN_LEVEL.., ADMIN...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x10670f420>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x10670f2e0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x106383990>
          └ <app.core.middleware.RateLimitMiddleware object at 0x106553810>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x10670f420>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x10670f2e0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x106356850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x106383990>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x10670f420>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x10670f2e0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │                            │    │    └ <starlette.requests.Request object at 0x10633b150>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1054296d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x106356850>
          └ <function wrap_app_handling_exceptions at 0x1050322a0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x10670f7e0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x10670f2e0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          └ <fastapi.routing.APIRouter object at 0x1054296d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x10670f7e0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x10670f2e0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1054296d0>>
          └ <fastapi.routing.APIRouter object at 0x1054296d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x10670f7e0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x10670f2e0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │     └ <function Route.handle at 0x105033a60>
          └ APIRoute(path='/api/auth/login', name='login_user', methods=['POST'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x10670f7e0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x10670f2e0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <function request_response.<locals>.app at 0x1066794e0>
          └ APIRoute(path='/api/auth/login', name='login_user', methods=['POST'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x10670f7e0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x10670f2e0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │                            │    └ <starlette.requests.Request object at 0x106356e90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x10670f880>
          └ <function wrap_app_handling_exceptions at 0x1050322a0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x10670f9c0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x10670f2e0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          └ <function request_response.<locals>.app.<locals>.app at 0x10670f880>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x106356e90>
                     └ <function get_request_handler.<locals>.app at 0x106679440>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x103140720>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x10671af90>, 'payload': LoginRequest(email='slebronov@mail.ru', password='1...
                 │                 │         └ <function login_user at 0x1062cf880>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x106682910>
                 └ <function run_in_threadpool at 0x104d6c680>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function login_user at 0x1062cf880>, db=<sqlalchemy.orm.session.Session object at 0x10671af90>, payload=Lo...
                 │     │         └ <function run_sync at 0x104d6ede0>
                 │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
                 └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x104d6e200>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=LookupError("'none' is not among the defined enum values. Enum name: admin_level. Possible values:...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/auth.py", line 70, in login_user
    user = db.scalar(select(User).where(User.email == payload.email))
           │  │      │      │           │    │        │       └ 'slebronov@mail.ru'
           │  │      │      │           │    │        └ LoginRequest(email='slebronov@mail.ru', password='12322828')
           │  │      │      │           │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x10629f9c0>
           │  │      │      │           └ <class 'app.models.user.User'>
           │  │      │      └ <class 'app.models.user.User'>
           │  │      └ <function select at 0x105b28180>
           │  └ <function Session.scalar at 0x105f1fa60>
           └ <sqlalchemy.orm.session.Session object at 0x10671af90>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2399, in scalar
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x105f1f4c0>
           └ <sqlalchemy.orm.session.Session object at 0x10671af90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2250, in _execute_internal
    return result.scalar()
           │      └ <function Result.scalar at 0x105c1c5e0>
           └ <sqlalchemy.engine.result.ChunkedIteratorResult object at 0x10691b090>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 1544, in scalar
    return self._only_one_row(
           │    └ <function ResultInternal._only_one_row at 0x105c1a3e0>
           └ <sqlalchemy.engine.result.ChunkedIteratorResult object at 0x10691b090>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 749, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
         │        │               │       └ <bound method IteratorResult._fetchone_impl of <sqlalchemy.engine.result.ChunkedIteratorResult object at 0x10691b090>>
         │        │               └ typing.Any
         │        └ typing.Union[~_R, typing.Tuple[typing.Any, ...]]
         └ typing.Optional
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 2259, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
               │    │         └ <_NoRow._NO_ROW: 0>
               │    └ <itertools.chain object at 0x1068dbcd0>
               └ <sqlalchemy.engine.result.ChunkedIteratorResult object at 0x10691b090>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 219, in chunks
    fetch = cursor._raw_all_rows()
            │      └ <function ResultInternal._raw_all_rows at 0x105c19f80>
            └ <sqlalchemy.engine.cursor.CursorResult object at 0x1068c1240>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            │                        └ [('16259c0ce7b34ed995fc5779c0e6c0fc', 'slebronov@mail.ru', 'e0ea031c46b22703cc404e573945e2d85d5bf6f74b88999038add119dab7cf00'...
            └ functools.partial(<class 'sqlalchemy.engine.row.Row'>, <sqlalchemy.engine.cursor.CursorResultMetaData object at 0x1068c14d0>,...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 541, in <listcomp>
    return [make_row(row) for row in rows]
            │        │        └ ('16259c0ce7b34ed995fc5779c0e6c0fc', 'slebronov@mail.ru', 'e0ea031c46b22703cc404e573945e2d85d5bf6f74b88999038add119dab7cf00',...
            │        └ ('16259c0ce7b34ed995fc5779c0e6c0fc', 'slebronov@mail.ru', 'e0ea031c46b22703cc404e573945e2d85d5bf6f74b88999038add119dab7cf00',...
            └ functools.partial(<class 'sqlalchemy.engine.row.Row'>, <sqlalchemy.engine.cursor.CursorResultMetaData object at 0x1068c14d0>,...
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 1729, in process
    value = self._object_value_for_elem(value)
            │    │                      └ 'none'
            │    └ <function Enum._object_value_for_elem at 0x105a00ae0>
            └ Enum('NONE', 'ADMIN_LEVEL_1', 'ADMIN_LEVEL_2', 'ADMIN_LEVEL_3', name='admin_level', _create_events=False)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 1611, in _object_value_for_elem
    raise LookupError(

LookupError: 'none' is not among the defined enum values. Enum name: admin_level. Possible values: NONE, ADMIN_LEVEL.., ADMIN_LEVEL.., ADMIN_LEVEL..
[2025-10-17 02:09:59] ERROR — Unhandled exception at %s
Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 1609, in _object_value_for_elem
    return self._object_lookup[elem]
           │    │              └ 'BRAND'
           │    └ {'brand': <UserRole.BRAND: 'brand'>, 'creator': <UserRole.CREATOR: 'creator'>, 'agent': <UserRole.AGENT: 'agent'>, 'factory':...
           └ Enum('brand', 'creator', 'agent', 'factory', 'admin', 'viewer', name='user_role', _create_events=False)

KeyError: 'BRAND'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x104e2f600>
    └ <Thread(asyncio-portal-1082ee690, started daemon 6143979520)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x104e2f2e0>
    └ <Thread(asyncio-portal-1082ee690, started daemon 6143979520)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-1082ee690, started daemon 6143979520)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-1082ee690, started daemon 6143979520)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x1082f4040>
    └ <Thread(asyncio-portal-1082ee690, started daemon 6143979520)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 519, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x105b79760>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_core/_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x1082a3ce0>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x108334860>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2325, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x1082f4180>
           │      └ <function Runner.run at 0x10535b240>
           └ <asyncio.runners.Runner object at 0x108321350>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x105358e00>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x108321350>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 641, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x105358d60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 608, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10535ab60>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1936, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10521b380>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 252, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x1082baa40>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x104bc8540>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x107177240>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x104bc8540>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x107177240>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x108341490>
          └ <fastapi.applications.FastAPI object at 0x1081d8710>
> File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x108336980>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x107177240>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <app.core.middleware.AdminActionMiddleware object at 0x108341450>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x108341490>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x106c8e160>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x108543dc0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [LookupError("'BRAND' is not among the defined enum values. Enum name: user...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x108316960>
    └ <contextlib._GeneratorContextManager object at 0x1083414d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x108336a20>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x107fa9150>
                     │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x108341450>>
                     └ <app.core.middleware.AdminActionMiddleware object at 0x108341450>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x107fa9150>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x108336a20>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ LookupError("'BRAND' is not among the defined enum values. Enum name: user_role. Possible values: brand, creator, agent, ...,...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x108336c00>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x108336ac0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x1083413d0>
          └ <app.core.middleware.AdminActionMiddleware object at 0x108341450>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x106c8e160>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x108543c40>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [LookupError("'BRAND' is not among the defined enum values. Enum name: user...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x108316dc0>
    └ <contextlib._GeneratorContextManager object at 0x108341990>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x108336e80>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x108341890>
                     │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x1083413d0>>
                     └ <app.core.middleware.RequestLoggerMiddleware object at 0x1083413d0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x108341890>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x108336e80>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ LookupError("'BRAND' is not among the defined enum values. Enum name: user_role. Possible values: brand, creator, agent, ...,...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x108337060>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x108336f20>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <app.core.middleware.RateLimitMiddleware object at 0x107f8bad0>
          └ <app.core.middleware.RequestLoggerMiddleware object at 0x1083413d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x106c8e160>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x108543ac0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [LookupError("'BRAND' is not among the defined enum values. Enum name: user...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x108317680>
    └ <contextlib._GeneratorContextManager object at 0x108341fd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1083372e0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x108341f10>
                     │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x107f8bad0>>
                     └ <app.core.middleware.RateLimitMiddleware object at 0x107f8bad0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    return await call_next(request)
                 │         └ <starlette.middleware.base._CachedRequest object at 0x108341f10>
                 └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1083372e0>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ LookupError("'BRAND' is not among the defined enum values. Enum name: user_role. Possible values: brand, creator, agent, ...,...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x108337560>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x108337420>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x107f8a310>
          └ <app.core.middleware.RateLimitMiddleware object at 0x107f8bad0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x108337560>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x108337420>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x107f88350>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x107f8a310>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x108337560>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x108337420>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │                            │    │    └ <starlette.requests.Request object at 0x108342690>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1070f57d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x107f88350>
          └ <function wrap_app_handling_exceptions at 0x106cfe2a0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x108337920>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x108337420>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          └ <fastapi.routing.APIRouter object at 0x1070f57d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x108337920>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x108337420>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1070f57d0>>
          └ <fastapi.routing.APIRouter object at 0x1070f57d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x108337920>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x108337420>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │     └ <function Route.handle at 0x106cffa60>
          └ APIRoute(path='/api/auth/login', name='login_user', methods=['POST'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x108337920>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x108337420>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │    └ <function request_response.<locals>.app at 0x1082a1620>
          └ APIRoute(path='/api/auth/login', name='login_user', methods=['POST'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x108337920>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x108337420>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          │                            │    └ <starlette.requests.Request object at 0x10816e110>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1083379c0>
          └ <function wrap_app_handling_exceptions at 0x106cfe2a0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x108337b00>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x108337420>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'POST', 'path': '/api/auth/login', 'raw_path': b'/api/auth/login', 'root_pa...
          └ <function request_response.<locals>.app.<locals>.app at 0x1083379c0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x10816e110>
                     └ <function get_request_handler.<locals>.app at 0x1082a1580>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x104d28720>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x108343c50>, 'payload': LoginRequest(email='slebronov@mail.ru', password='1...
                 │                 │         └ <function login_user at 0x107eef9c0>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x1082a6e50>
                 └ <function run_in_threadpool at 0x105b78680>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function login_user at 0x107eef9c0>, db=<sqlalchemy.orm.session.Session object at 0x108343c50>, payload=Lo...
                 │     │         └ <function run_sync at 0x105b7ade0>
                 │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
                 └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x105b7a200>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=LookupError("'BRAND' is not among the defined enum values. Enum name: user_role. Possible values: ...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/auth.py", line 70, in login_user
    user = db.scalar(select(User).where(User.email == payload.email))
           │  │      │      │           │    │        │       └ 'slebronov@mail.ru'
           │  │      │      │           │    │        └ LoginRequest(email='slebronov@mail.ru', password='12322828')
           │  │      │      │           │    └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x107ebfb00>
           │  │      │      │           └ <class 'app.models.user.User'>
           │  │      │      └ <class 'app.models.user.User'>
           │  │      └ <function select at 0x10774c180>
           │  └ <function Session.scalar at 0x107b43a60>
           └ <sqlalchemy.orm.session.Session object at 0x108343c50>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2399, in scalar
    return self._execute_internal(
           │    └ <function Session._execute_internal at 0x107b434c0>
           └ <sqlalchemy.orm.session.Session object at 0x108343c50>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2250, in _execute_internal
    return result.scalar()
           │      └ <function Result.scalar at 0x1078405e0>
           └ <sqlalchemy.engine.result.ChunkedIteratorResult object at 0x108543150>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 1544, in scalar
    return self._only_one_row(
           │    └ <function ResultInternal._only_one_row at 0x10783e3e0>
           └ <sqlalchemy.engine.result.ChunkedIteratorResult object at 0x108543150>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 749, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
         │        │               │       └ <bound method IteratorResult._fetchone_impl of <sqlalchemy.engine.result.ChunkedIteratorResult object at 0x108543150>>
         │        │               └ typing.Any
         │        └ typing.Union[~_R, typing.Tuple[typing.Any, ...]]
         └ typing.Optional
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 2259, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
               │    │         └ <_NoRow._NO_ROW: 0>
               │    └ <itertools.chain object at 0x1084fbe50>
               └ <sqlalchemy.engine.result.ChunkedIteratorResult object at 0x108543150>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 219, in chunks
    fetch = cursor._raw_all_rows()
            │      └ <function ResultInternal._raw_all_rows at 0x10783df80>
            └ <sqlalchemy.engine.cursor.CursorResult object at 0x1084e1240>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            │                        └ [('16259c0ce7b34ed995fc5779c0e6c0fc', 'slebronov@mail.ru', 'e0ea031c46b22703cc404e573945e2d85d5bf6f74b88999038add119dab7cf00'...
            └ functools.partial(<class 'sqlalchemy.engine.row.Row'>, <sqlalchemy.engine.cursor.CursorResultMetaData object at 0x1084e14d0>,...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 541, in <listcomp>
    return [make_row(row) for row in rows]
            │        │        └ ('16259c0ce7b34ed995fc5779c0e6c0fc', 'slebronov@mail.ru', 'e0ea031c46b22703cc404e573945e2d85d5bf6f74b88999038add119dab7cf00',...
            │        └ ('16259c0ce7b34ed995fc5779c0e6c0fc', 'slebronov@mail.ru', 'e0ea031c46b22703cc404e573945e2d85d5bf6f74b88999038add119dab7cf00',...
            └ functools.partial(<class 'sqlalchemy.engine.row.Row'>, <sqlalchemy.engine.cursor.CursorResultMetaData object at 0x1084e14d0>,...
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 1729, in process
    value = self._object_value_for_elem(value)
            │    │                      └ 'BRAND'
            │    └ <function Enum._object_value_for_elem at 0x1076acae0>
            └ Enum('brand', 'creator', 'agent', 'factory', 'admin', 'viewer', name='user_role', _create_events=False)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 1611, in _object_value_for_elem
    raise LookupError(

LookupError: 'BRAND' is not among the defined enum values. Enum name: user_role. Possible values: brand, creator, agent, ..., viewer
[2025-10-17 02:10:27] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (26.11 ms)
[2025-10-17 02:10:27] INFO — [REQUEST] POST /api/auth/refresh from unknown -> 200 (3.07 ms)
[2025-10-17 02:10:27] ERROR — Unhandled exception at %s
Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 1609, in _object_value_for_elem
    return self._object_lookup[elem]
           │    │              └ 'NONE'
           │    └ {'none': <AdminLevel.NONE: 'none'>, 'admin_level_1': <AdminLevel.ADMIN_LEVEL_1: 'admin_level_1'>, 'admin_level_2': <AdminLeve...
           └ Enum('none', 'admin_level_1', 'admin_level_2', 'admin_level_3', name='admin_level', _create_events=False)

KeyError: 'NONE'


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x10517f6a0>
    └ <Thread(asyncio-portal-108900c50, started daemon 6140506112)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x10517f380>
    └ <Thread(asyncio-portal-108900c50, started daemon 6140506112)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(asyncio-portal-108900c50, started daemon 6140506112)>
    │    │        │    └ ()
    │    │        └ <Thread(asyncio-portal-108900c50, started daemon 6140506112)>
    │    └ <function start_blocking_portal.<locals>.run_blocking_portal at 0x1086e2b60>
    └ <Thread(asyncio-portal-108900c50, started daemon 6140506112)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 519, in run_blocking_portal
    run_eventloop(
    └ <function run at 0x105ebd800>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_core/_eventloop.py", line 74, in run
    return async_backend.run(func, args, {}, backend_options)
           │             │   │     │         └ {}
           │             │   │     └ ()
           │             │   └ <function start_blocking_portal.<locals>.run_portal at 0x1086e2f20>
           │             └ <classmethod(<function AsyncIOBackend.run at 0x1086e0900>)>
           └ <class 'anyio._backends._asyncio.AsyncIOBackend'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2325, in run
    return runner.run(wrapper())
           │      │   └ <function start_blocking_portal.<locals>.run_portal at 0x1086e2ca0>
           │      └ <function Runner.run at 0x10569f2e0>
           └ <asyncio.runners.Runner object at 0x108900750>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='anyio.from_thread.start_blocking_portal.<locals>.run_portal' coro=<start_blocking_portal.<locals>.run_por...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x10569cea0>
           │    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x108900750>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 641, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x10569ce00>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 608, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x10569ec00>
    └ <_UnixSelectorEventLoop running=True closed=False debug=False>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 1936, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x10555f420>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup(<Future cancelled>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup(<Future cancelled>)>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/from_thread.py", line 252, in _call_func
    retval = await retval_or_awaitable
                   └ <coroutine object FastAPI.__call__ at 0x1086c8a40>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1086e2ac0>
                           │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1086a3f60>
                           └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function _TestClientTransport.handle_request.<locals>.send at 0x1086e2ac0>
          │    │                │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1086a3f60>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1086e9010>
          └ <fastapi.applications.FastAPI object at 0x1085844d0>
> File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x1086e3880>
          │    │   │      └ <function _TestClientTransport.handle_request.<locals>.receive at 0x1086a3f60>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          │    └ <app.core.middleware.AdminActionMiddleware object at 0x1086e8fd0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x1086e9010>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x10709a200>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x108914ec0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [LookupError("'NONE' is not among the defined enum values. Enum name: admin...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1088df3e0>
    └ <contextlib._GeneratorContextManager object at 0x108900350>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1086e3ce0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1089002d0>
                     │    └ <bound method AdminActionMiddleware.dispatch of <app.core.middleware.AdminActionMiddleware object at 0x1086e8fd0>>
                     └ <app.core.middleware.AdminActionMiddleware object at 0x1086e8fd0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 102, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x1089002d0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1086e3ce0>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ LookupError("'NONE' is not among the defined enum values. Enum name: admin_level. Possible values: none, admin_level.., admin...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1086e32e0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1086e27a0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          │    └ <app.core.middleware.RequestLoggerMiddleware object at 0x10863f5d0>
          └ <app.core.middleware.AdminActionMiddleware object at 0x1086e8fd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x10709a200>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x108914d40>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [LookupError("'NONE' is not among the defined enum values. Enum name: admin...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1088df680>
    └ <contextlib._GeneratorContextManager object at 0x108900450>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x105d959e0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x108901850>
                     │    └ <bound method RequestLoggerMiddleware.dispatch of <app.core.middleware.RequestLoggerMiddleware object at 0x10863f5d0>>
                     └ <app.core.middleware.RequestLoggerMiddleware object at 0x10863f5d0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 25, in dispatch
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x108901850>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x105d959e0>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ LookupError("'NONE' is not among the defined enum values. Enum name: admin_level. Possible values: none, admin_level.., admin...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1086e3600>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1086e3100>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          │    └ <app.core.middleware.RateLimitMiddleware object at 0x1083378d0>
          └ <app.core.middleware.RequestLoggerMiddleware object at 0x10863f5d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 189, in __call__
    with collapse_excgroups():
         └ <function collapse_excgroups at 0x10709a200>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x108914bc0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [LookupError("'NONE' is not among the defined enum values. Enum name: admin...
    │    │   │     └ <class 'ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x1088df920>
    └ <contextlib._GeneratorContextManager object at 0x1086eab90>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_utils.py", line 93, in collapse_excgroups
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 191, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1086e3240>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x1086e94d0>
                     │    └ <bound method RateLimitMiddleware.dispatch of <app.core.middleware.RateLimitMiddleware object at 0x1083378d0>>
                     └ <app.core.middleware.RateLimitMiddleware object at 0x1083378d0>

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/core/middleware.py", line 74, in dispatch
    return await call_next(request)
                 │         └ <starlette.middleware.base._CachedRequest object at 0x1086e94d0>
                 └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x1086e3240>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 165, in call_next
    raise app_exc
          └ LookupError("'NONE' is not among the defined enum values. Enum name: admin_level. Possible values: none, admin_level.., admin...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/base.py", line 151, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1088ed3a0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1088ee2a0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x1083260d0>
          └ <app.core.middleware.RateLimitMiddleware object at 0x1083378d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1088ed3a0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1088ee2a0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x108326850>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x1083260d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x1088ed3a0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1088ee2a0>
          │                            │    │    │     └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          │                            │    │    └ <starlette.requests.Request object at 0x1089059d0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x1075018d0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x108326850>
          └ <function wrap_app_handling_exceptions at 0x10710a340>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1088ee340>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1088ee2a0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          └ <fastapi.routing.APIRouter object at 0x1075018d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1088ee340>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1088ee2a0>
          │    │                └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x1075018d0>>
          └ <fastapi.routing.APIRouter object at 0x1075018d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1088ee340>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1088ee2a0>
          │     │      └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          │     └ <function Route.handle at 0x10710bb00>
          └ APIRoute(path='/api/admin/users', name='list_users', methods=['GET'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1088ee340>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1088ee2a0>
          │    │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          │    └ <function request_response.<locals>.app at 0x10864f060>
          └ APIRoute(path='/api/admin/users', name='list_users', methods=['GET'])
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1088ee340>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1088ee2a0>
          │                            │    │        └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          │                            │    └ <starlette.requests.Request object at 0x108905990>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x1088ee3e0>
          └ <function wrap_app_handling_exceptions at 0x10710a340>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x1088ee520>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x1088ee2a0>
          │   └ {'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/api/admin/users', 'raw_path': b'/api/admin/users', 'root_p...
          └ <function request_response.<locals>.app.<locals>.app at 0x1088ee3e0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x108905990>
                     └ <function get_request_handler.<locals>.app at 0x10864efc0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x1050787c0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'db': <sqlalchemy.orm.session.Session object at 0x108906450>, 'admin_user': <app.models.user.User object at 0x108814850>}
                 │                 │         └ <function list_users at 0x108362340>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x108680b50>
                 └ <function run_in_threadpool at 0x105ebc720>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function list_users at 0x108362340>, db=<sqlalchemy.orm.session.Session object at 0x108906450>, admin_user...
                 │     │         └ <function run_sync at 0x105ebee80>
                 │     └ <module 'anyio.to_thread' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thre...
                 └ <module 'anyio' from '/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/__init__.py'>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x105ebe2a0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 2485, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=LookupError("'NONE' is not among the defined enum values. Enum name: admin_level. Possible values:...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 976, in run
    result = context.run(func, *args)

  File "/Users/roksana/Desktop/project/ugc_mp/backend/app/api/admin/users.py", line 25, in list_users
    users = db.query(User).all()
            │  │     └ <class 'app.models.user.User'>
            │  └ <function Session.query at 0x107f04a40>
            └ <sqlalchemy.orm.session.Session object at 0x108906450>

  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2673, in all
    return self._iter().all()  # type: ignore
           │    └ <function Query._iter at 0x107e63740>
           └ <sqlalchemy.orm.query.Query object at 0x108327dd0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 1769, in all
    return self._allrows()
           │    └ <function ResultInternal._allrows at 0x107bea0c0>
           └ <sqlalchemy.engine.result.ScalarResult object at 0x1088f8d70>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 548, in _allrows
    rows = self._fetchall_impl()
           │    └ <function FilterResult._fetchall_impl at 0x107bf1120>
           └ <sqlalchemy.engine.result.ScalarResult object at 0x1088f8d70>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 1676, in _fetchall_impl
    return self._real_result._fetchall_impl()
           │    └ <member '_real_result' of 'FilterResult' objects>
           └ <sqlalchemy.engine.result.ScalarResult object at 0x1088f8d70>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 2270, in _fetchall_impl
    return list(self.iterator)
                │    └ <list_iterator object at 0x1088f7af0>
                └ <sqlalchemy.engine.result.ChunkedIteratorResult object at 0x108907ed0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 219, in chunks
    fetch = cursor._raw_all_rows()
            │      └ <function ResultInternal._raw_all_rows at 0x107bea020>
            └ <sqlalchemy.engine.cursor.CursorResult object at 0x1088911d0>
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            │                        └ [('43a309ac285f4edab40f4215dbfa4ca0', 'brand_auto@example.com', 'fbf544dbdd9b07d66875c317b12b620bc1c2ef23dda38b60e6b29b51744f...
            └ functools.partial(<class 'sqlalchemy.engine.row.Row'>, <sqlalchemy.engine.cursor.CursorResultMetaData object at 0x108891690>,...
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/engine/result.py", line 541, in <listcomp>
    return [make_row(row) for row in rows]
            │        │        └ ('a067c355193f43d9b25dc9cd93f978f8', 'test500@example.com', 'fbf544dbdd9b07d66875c317b12b620bc1c2ef23dda38b60e6b29b51744fdcfb...
            │        └ ('a067c355193f43d9b25dc9cd93f978f8', 'test500@example.com', 'fbf544dbdd9b07d66875c317b12b620bc1c2ef23dda38b60e6b29b51744fdcfb...
            └ functools.partial(<class 'sqlalchemy.engine.row.Row'>, <sqlalchemy.engine.cursor.CursorResultMetaData object at 0x108891690>,...
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 1729, in process
    value = self._object_value_for_elem(value)
            │    │                      └ 'NONE'
            │    └ <function Enum._object_value_for_elem at 0x107a58b80>
            └ Enum('none', 'admin_level_1', 'admin_level_2', 'admin_level_3', name='admin_level', _create_events=False)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/sqlalchemy/sql/sqltypes.py", line 1611, in _object_value_for_elem
    raise LookupError(

LookupError: 'NONE' is not among the defined enum values. Enum name: admin_level. Possible values: none, admin_level.., admin_level.., admin_level..
[2025-10-17 02:10:46] INFO — [REQUEST] POST /api/auth/login from unknown -> 200 (26.03 ms)
[2025-10-17 02:10:46] INFO — [REQUEST] POST /api/auth/refresh from unknown -> 200 (2.96 ms)
[2025-10-17 02:10:46] INFO — [REQUEST] GET /api/admin/users from unknown -> 200 (2.69 ms)
[2025-10-17 02:10:46] INFO — admin_action method=GET path=/api/admin/users status=200 admin_id=16259c0c-e7b3-4ed9-95fc-5779c0e6c0fc
